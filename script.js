// –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤
const products = [
    // –°–ú–ê–†–¢–§–û–ù–´
    {
        id: 1,
        name: "iPhone 15 Pro Max",
        description: "–§–ª–∞–≥–º–∞–Ω—Å–∫–∏–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω Apple —Å —Ç–∏—Ç–∞–Ω–æ–≤—ã–º –∫–æ—Ä–ø—É—Å–æ–º –∏ —É–ª—É—á—à–µ–Ω–Ω–æ–π –∫–∞–º–µ—Ä–æ–π. –í—ã—Å–æ—á–∞–π—à–∏–π —É—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.",
        price: 129990,
        category: "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã",
        hasColors: true,
        colors: {
            "–ß–µ—Ä–Ω—ã–π": {
                image: "images/15 pro max/15 pro max black/top1.webp",
                images: [
                    "images/15 pro max/15 pro max black/top1.webp",
                    "images/15 pro max/15 pro max black/08fcd9b8265ee819547e65399faa3c2858ed767d03a126ce226fbd4dcdbc9b7f.jpg.webp",
                    "images/15 pro max/15 pro max black/6f878d28c47b7aafce03870c5e00781ba530051ba788c07a2acd1e47b5a0c49f.jpg.webp",
                    "images/15 pro max/15 pro max black/6f8fe505a22427c326d5e21e89fe319d8678d18117db92ee145b796bc5a3170c.jpg.webp",
                    "images/15 pro max/15 pro max black/90521544990b8b6141a0ceb95cb3c92b1c1f67aec43e5bf3c102e0bf1ed55066.jpg.webp",
                    "images/15 pro max/15 pro max black/9b5079c958ad321a3ee57aadebbde9830fc35b3cd0a6ea3eb31483a6b78a6597.jpg.webp",
                    "images/15 pro max/15 pro max black/e5dfaaf92fa0a6b31e9cccb4d88a5d1a58ce35c97b055efae6f1373ee6be0e5b.jpg.webp"
                ]
            },
            "–°–∏–Ω–∏–π": {
                image: "images/15 pro max/15 pro max blue/1e3d6dc283feae1a340a1d1fbdb7a9411a9ba77beb798b5b19d40762feaa2944.jpg.webp",
                images: [
                    "images/15 pro max/15 pro max blue/1e3d6dc283feae1a340a1d1fbdb7a9411a9ba77beb798b5b19d40762feaa2944.jpg.webp",
                    "images/15 pro max/15 pro max blue/dfad8d15bb00ae2a0c4d249fa9011308a4167f2229e08d79f8f0a41cf90464b6.jpg.webp",
                    "images/15 pro max/15 pro max blue/0955d5df4a099b1ce81bf9fde22d2cb0bacd6174308a923d735003ade9494bd8.jpg.webp",
                    "images/15 pro max/15 pro max blue/1d1a9c3dbc648ff7ec6961c38ff6ae51918745870de15fb7221d2f01341f4ea9.jpg.webp",
                    "images/15 pro max/15 pro max blue/956219dff170e579b115fcaa3a416a76989b450a76e33f83de5d8a39f4dce1f1.jpg.webp",
                    "images/15 pro max/15 pro max blue/9d67c8001e32cb3a8e6f0afdae999057b97ab0cc0b3260025743f9fe218fa9df.jpg.webp",
                    "images/15 pro max/15 pro max blue/d05c0400f3ee7accd4b77399c39f16623d1a2230b09b46b4de437dad6dcef890.jpg.webp"
                ]
            },
            "–°–µ—Ä—ã–π": {
                image: "images/15 pro max/15 pro max grey/top1.webp",
                images: [
                    "images/15 pro max/15 pro max grey/top1.webp",
                    "images/15 pro max/15 pro max grey/08de377a334a375eeea526e445142e522659d533e9f6c41955a6bcfc53f8beff.jpg.webp",
                    "images/15 pro max/15 pro max grey/5479bdbbf374834d02bfe18dd0ab0cd2c815c57c282245d55c4dec6c3c11a5b0.jpg.webp",
                    "images/15 pro max/15 pro max grey/7b24e33d2373b6589b15b3f27d1f39fb25667bbb235b0b620482cfc816e03687.jpg.webp",
                    "images/15 pro max/15 pro max grey/8421f22cdca8acfda0d58b7be17e3dae07e7673e80800f30c810680bdc34468f.jpg.webp",
                    "images/15 pro max/15 pro max grey/f87841f854f495d474080bd3981127993cbd2639ede8759be19655c0cddd585b.jpg.webp"
                ]
            },
            "–ë–µ–ª—ã–π": {
                image: "images/15 pro max/15 pro max white/top1.webp",
                images: [
                    "images/15 pro max/15 pro max white/top1.webp",
                    "images/15 pro max/15 pro max white/1bb0489045b486cfd30181c16d25ebf73de0e0bf9a6f6cafee935a7f951f3129.jpg.webp",
                    "images/15 pro max/15 pro max white/49f57adcb9ac3dfdc74d84e32e64130db4039cf7d8a4ac3e6419192ed9a3cb4c.jpg.webp",
                    "images/15 pro max/15 pro max white/57897c2ef5f9cc2742949e7d5a60efb32d5aa3b08828375f64e677a1a1d87cdb.jpg.webp",
                    "images/15 pro max/15 pro max white/61c1447b4a493f5861ac48df0cbc1aac3c38e7701c9fa0abf6de612776f4a1f0.jpg.webp",
                    "images/15 pro max/15 pro max white/7882e8e6ffffcfef73224bc2f4720db1af68db4487a294465fb25d97bff4f622.jpg.webp",
                    "images/15 pro max/15 pro max white/c182e6f7e86b91e2cfc1cda35b279d67677eb5d2e51c740f9e349563728b6111.jpg.webp"
                ]
            }
        },
        image: "images/15 pro max/15 pro max black/top1.webp",
        images: [
            "images/15 pro max/15 pro max black/top1.webp",
            "images/15 pro max/15 pro max black/08fcd9b8265ee819547e65399faa3c2858ed767d03a126ce226fbd4dcdbc9b7f.jpg.webp",
            "images/15 pro max/15 pro max black/6f878d28c47b7aafce03870c5e00781ba530051ba788c07a2acd1e47b5a0c49f.jpg.webp",
            "images/15 pro max/15 pro max black/6f8fe505a22427c326d5e21e89fe319d8678d18117db92ee145b796bc5a3170c.jpg.webp",
            "images/15 pro max/15 pro max black/90521544990b8b6141a0ceb95cb3c92b1c1f67aec43e5bf3c102e0bf1ed55066.jpg.webp",
            "images/15 pro max/15 pro max black/9b5079c958ad321a3ee57aadebbde9830fc35b3cd0a6ea3eb31483a6b78a6597.jpg.webp",
            "images/15 pro max/15 pro max black/e5dfaaf92fa0a6b31e9cccb4d88a5d1a58ce35c97b055efae6f1373ee6be0e5b.jpg.webp"
        ],
        specs: [
            "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: Apple A17 Pro",
            "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å: 8 GB",
            "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å: 256 GB",
            "–≠–∫—Ä–∞–Ω: 6.7 –¥—é–π–º–∞ Super Retina XDR",
            "–ö–∞–º–µ—Ä–∞: 48 –ú–ø –æ—Å–Ω–æ–≤–Ω–æ–π + 12 –ú–ø —à–∏—Ä–æ–∫–æ—É–≥–æ–ª—å–Ω–∞—è + 12 –ú–ø —Ç–µ–ª–µ—Ñ–æ—Ç–æ",
            "–ö–æ—Ä–ø—É—Å: –¢–∏—Ç–∞–Ω, –∑–∞—â–∏—Ç–∞ IP68"
        ],
        has3D: true,
        model3D: "models/iphone 15 pro max black/apple_iphone_15_pro_max_black.glb",
        hasTradeIn: true
    },
    {
        id: 2,
        name: "Samsung Galaxy S24 Ultra",
        description: "–§–ª–∞–≥–º–∞–Ω Samsung —Å S Pen, 200 –ú–ø –∫–∞–º–µ—Ä–æ–π –∏ AI-—Ñ—É–Ω–∫—Ü–∏—è–º–∏. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ.",
        price: 109990,
        category: "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã",
        hasColors: true,
        colors: {
            "–ß–µ—Ä–Ω—ã–π": {
                image: "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/top1.webp",
                images: [
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/top1.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/1af0087ca2964d0b1f5befccc57db0a68268e0e848a74ebbd57808cde8923ce0.jpg.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/54408be572f1ef1f554c98c89db8f486f897db036e03f0829a6c8ba7f8c3858a.jpg.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/59adff8cbfd3be6e2d1b2a6d741772dec7a3e4155e3878ad01f26e9a7bec5d6a.jpg.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/5e920095534d841c364c6c5f99e952051f973c345666d4cce875c294d4810783.jpg.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/9cb58590a922fab2e038568c13325771d7fa201e93312914a5bc249fb8cf8264.jpg.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/c517ef1b94b9605473f47cc54e1b5d580c2bff4d09a1deb36e475eb260ba5233.jpg.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/ee70c5559e3f4be3236e1348578af80a05c759733c8d4819b7b2fef2ec04d406.jpg.webp",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/fcfae337e6632c685c5f9c9be5fd075cb5178de250731e2ebc365dc27c5e442a.jpg.webp"
                ]
            },
            "–ó–æ–ª–æ—Ç–æ–π": {
                image: "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra gold/top1.png",
                images: [
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra gold/top1.png",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra gold/rfqb3q2iu64ok6rchal2yfmdwq7jn8ss.jpg",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra gold/fg09lglpryatlo8fw70we1yafgdopk25.jpg",
                    "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra gold/qv781u7c8kyqbupcs1bwbbxa2bz28a8f.png"
                ]
            }
        },
        image: "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/top1.webp",
        images: [
            "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/top1.webp",
            "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/1af0087ca2964d0b1f5befccc57db0a68268e0e848a74ebbd57808cde8923ce0.jpg.webp",
            "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/54408be572f1ef1f554c98c89db8f486f897db036e03f0829a6c8ba7f8c3858a.jpg.webp",
            "images/Samsung Galaxy S24 Ultra/Samsung Galaxy S24 Ultra black/59adff8cbfd3be6e2d1b2a6d741772dec7a3e4155e3878ad01f26e9a7bec5d6a.jpg.webp"
        ],
        specs: [
            "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: Snapdragon 8 Gen 3",
            "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å: 12 GB",
            "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å: 256 GB",
            "–≠–∫—Ä–∞–Ω: 6.8 –¥—é–π–º–∞ Dynamic AMOLED 2X",
            "–ö–∞–º–µ—Ä–∞: 200 –ú–ø –æ—Å–Ω–æ–≤–Ω–æ–π + 12 –ú–ø —à–∏—Ä–æ–∫–æ—É–≥–æ–ª—å–Ω–∞—è + 50 –ú–ø —Ç–µ–ª–µ—Ñ–æ—Ç–æ",
            "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: S Pen –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ"
        ],
        has3D: true,
        model3D: "models/samsung_s24_ultra.glb",
        hasTradeIn: true
    },
    {
        id: 3,
        name: "iPhone 14",
        description: "–û—Ç–ª–∏—á–Ω—ã–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω Apple —Å —á–∏–ø–æ–º A15 Bionic. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∏–ª—å.",
        price: 69990,
        category: "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã",
        hasColors: true,
        colors: {
            "–ß–µ—Ä–Ω—ã–π": {
                image: "images/Iphone 14/Iphone 14 black/top1.webp",
                images: [
                    "images/Iphone 14/Iphone 14 black/top1.webp",
                    "images/Iphone 14/Iphone 14 black/0a70d96349830182e4aaffdcc003f9f623b393b07df9849c2ff38526c09e1d95.jpg.webp",
                    "images/Iphone 14/Iphone 14 black/8dbc0f1c317b597f2edca902d1399ff6390715c53301034911803ac50c7ddad7.jpg.webp",
                    "images/Iphone 14/Iphone 14 black/952786efec8763d1231ade8feb27cc92a55db30934ad31085cc47cfd66542d54.jpg.webp",
                    "images/Iphone 14/Iphone 14 black/b00b66b231494783c787e909f5024af3569db7f94c64e3d06c916a888c61d0b2.jpg.webp",
                    "images/Iphone 14/Iphone 14 black/f4dc053587ce7dd6326ba898a16bb65c9edef060e8fb651c7ef28331f4a469a7.jpg.webp"
                ]
            },
            "–ë–µ–ª—ã–π": {
                image: "images/Iphone 14/Iphone 14 white/top1.webp",
                images: [
                    "images/Iphone 14/Iphone 14 white/top1.webp",
                    "images/Iphone 14/Iphone 14 white/0ea9d0c25a0ce7c01343c89a5b6601ef0c0d5546b3c28b377540fbea90aa5f12.jpg.webp",
                    "images/Iphone 14/Iphone 14 white/310687a01978aea2e2911d0737fc6853443d1215f0ff1e74e8afde87827a78ec.jpg.webp",
                    "images/Iphone 14/Iphone 14 white/79e880b6e5abef4be29ad8d4f000acab82b65081386e4eacfb930cd5e7f31508.jpg.webp",
                    "images/Iphone 14/Iphone 14 white/d8aad887d960e65fc68840e1725d0c8e4f29d79373809076aa408c3e88b56ab4.jpg.webp",
                    "images/Iphone 14/Iphone 14 white/df20a46e920dcc78d67302d181c2a9940b8bde6b031cefc4efc3ab718e7e4777.jpg.webp"
                ]
            }
        },
        image: "images/Iphone 14/Iphone 14 black/top1.webp",
        images: [
            "images/Iphone 14/Iphone 14 black/top1.webp",
            "images/Iphone 14/Iphone 14 black/0a70d96349830182e4aaffdcc003f9f623b393b07df9849c2ff38526c09e1d95.jpg.webp",
            "images/Iphone 14/Iphone 14 black/8dbc0f1c317b597f2edca902d1399ff6390715c53301034911803ac50c7ddad7.jpg.webp"
        ],
        specs: [
            "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: Apple A15 Bionic",
            "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å: 6 GB",
            "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å: 128 GB",
            "–≠–∫—Ä–∞–Ω: 6.1 –¥—é–π–º–∞ Super Retina XDR",
            "–ö–∞–º–µ—Ä–∞: 12 –ú–ø + 12 –ú–ø —à–∏—Ä–æ–∫–æ—É–≥–æ–ª—å–Ω–∞—è",
            "–ë–∞—Ç–∞—Ä–µ—è: –¥–æ 20 —á–∞—Å–æ–≤ –≤–∏–¥–µ–æ"
        ],
        has3D: true,
        model3D: "models/iphone 14/iphone_14.glb"
    },
    
    // –ù–ê–£–®–ù–ò–ö–ò
    {
        id: 4,
        name: "AirPods Pro 2",
        description: "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–≤—É–∫–æ–º. –ö–∞—Å—Ç–æ–º–Ω—ã–π —á–∏–ø H2.",
        price: 25990,
        category: "–ù–∞—É—à–Ω–∏–∫–∏",
        image: "images/AirPods Pro 2/top1.webp",
        images: [
            "images/AirPods Pro 2/top1.webp",
            "images/AirPods Pro 2/1930777d7cc89fa47668ef6c1de8ebd9c72acb0fdb8be9da0005b6c9e0f1bb45.jpg.webp",
            "images/AirPods Pro 2/597e8ebaf3543bbf29c7a493f0f950e3ef37c968d91ba06c9d0ec0ebbbd2af82.jpg.webp",
            "images/AirPods Pro 2/6b763a717847bc998576762b76186be0e05a7eecc90839493630352e08b2a30d.jpg.webp",
            "images/AirPods Pro 2/774623d144281be3667c178ad7f1572b013471e7f0bde741442132bbd6605a78.jpg.webp",
            "images/AirPods Pro 2/f01073c7927b654a35eafaf6292c50c818433d7749dfcc822b76c09fded4ffba.jpg.webp",
            "images/AirPods Pro 2/fb4ce035f130b7812895d06d2db154b87347d28044c3b7615f89a139e7f82c0e.jpg.webp"
        ],
        specs: [
            "–ß–∏–ø: H2 –æ—Ç Apple",
            "–ê–∫—Ç–∏–≤–Ω–æ–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ",
            "–ë–∞—Ç–∞—Ä–µ—è: 6 —á–∞—Å–æ–≤, 30 —á–∞—Å–æ–≤ –≤ —á–µ—Ö–ª–µ",
            "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞: IPX4",
            "–ó–≤—É–∫: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –∞—É–¥–∏–æ"
        ],
        has3D: true,
        model3D: "models/AirPods Pro 2/airpods_pro_with_magsafe_charging_case_ios15.glb"
    },
    {
        id: 5,
        name: "Sony WH-1000XM5",
        description: "–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ —Å –ª—É—á—à–∏–º –≤ –º–∏—Ä–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω –∏ —É–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–≤—É—á–∞–Ω–∏–µ.",
        price: 39990,
        category: "–ù–∞—É—à–Ω–∏–∫–∏",
        image: "images/Sony WH-1000XM5/top1.webp",
        images: [
            "images/Sony WH-1000XM5/top1.webp",
            "images/Sony WH-1000XM5/04937f6f234439401b88ee3d36fbb07c610c68690dafccda99b0d9523665f477.jpg.webp",
            "images/Sony WH-1000XM5/360059d5fc2d5c02b399546df60f2d30b763288952d9788df3e4d20a80bba9ac.jpg.webp",
            "images/Sony WH-1000XM5/6d3296f06d32ff1d0f5a8627359f5a47eb379c35c9314b7c3117d01922eee735.jpg.webp",
            "images/Sony WH-1000XM5/c6faee61c83b54e73d38a4bad8552d5d758d50b43c2d3f2f24bd2777bd387f3f.jpg.webp",
            "images/Sony WH-1000XM5/da9e742289e85bbff398e7b3fc1d6e7cfce693fd9644c8c15efdb6badd484644.jpg.webp",
            "images/Sony WH-1000XM5/f19ea817ea58bbd3e66cbe792c85b53bec71f4b88ae65975977b2c603e71994d.jpg.webp"
        ],
        specs: [
            "Bluetooth: 5.2",
            "–ê–∫—Ç–∏–≤–Ω–æ–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ",
            "–ë–∞—Ç–∞—Ä–µ—è: 30 —á–∞—Å–æ–≤ —Å ANC, 40 —á–∞—Å–æ–≤ –±–µ–∑",
            "–ó–∞—Ä—è–¥–∫–∞: USB-C, –±—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞",
            "–í–µ—Å: 250 –≥",
            "–ó–≤—É–∫: HD Noise Canceling Processor QN1"
        ],
        has3D: true,
        model3D: "models/Sony WH-1000XM5/sony_wh-1000xm5.glb"
    },
    {
        id: 6,
        name: "JBL Tune 510BT",
        description: "–ù–∞–¥–µ–∂–Ω—ã–µ Bluetooth –Ω–∞—É—à–Ω–∏–∫–∏ —Å –±–∞—Å–æ–≤—ã–º –∑–≤—É–∫–æ–º. –û—Ç–ª–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞-–∫–∞—á–µ—Å—Ç–≤–æ.",
        price: 3990,
        category: "–ù–∞—É—à–Ω–∏–∫–∏",
        image: "images/JBL Tune 510BT/top1.webp",
        images: [
            "images/JBL Tune 510BT/top1.webp",
            "images/JBL Tune 510BT/24a54c6863a583df23ffbb471950dea3326bca61f62227251478ff9e82bdda2d.jpg.webp",
            "images/JBL Tune 510BT/2da7a38fda1f969a10e904d63792edfee9fcc890ab1492ddf6a7ef3f158acdcf.jpg.webp",
            "images/JBL Tune 510BT/3d1cca34800bd14d42430e1d9765b0e8bd7d92dc4e9da4a7a7bc696884706c05.jpg.webp",
            "images/JBL Tune 510BT/6ee93b14adc58124c82d5bcb8d1cd907cf5a78f03b74d121236dfb2fe235c08a.jpg.webp",
            "images/JBL Tune 510BT/c9f2797bbd91886904602fa2c815578062c07bd3b8667d85699137c7b04f07f2.jpg.webp"
        ],
        specs: [
            "Bluetooth: 5.0",
            "–ë–∞—Ç–∞—Ä–µ—è: –¥–æ 40 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
            "–ó–∞—Ä—è–¥–∫–∞: USB-C",
            "–°–∫–ª–∞–¥—ã–≤–∞—é—â–∏–µ—Å—è: –¥–∞",
            "–í–µ—Å: 160 –≥",
            "–ó–≤—É–∫: JBL Bass Boost"
        ],
        has3D: true,
        model3D: "models/JBL Tune 510BT/jbl_tune_720bt.glb"
    },
    
    // –£–ú–ù–´–ï –ß–ê–°–´
    {
        id: 7,
        name: "Apple Watch Series 9",
        description: "–£–º–Ω—ã–µ —á–∞—Å—ã Apple —Å —á–∏–ø–æ–º S9, –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –¥–∏—Å–ø–ª–µ–µ–º Retina –∏ —Ç–æ—á–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –∑–¥–æ—Ä–æ–≤—å—è.",
        price: 39990,
        category: "–£–º–Ω—ã–µ —á–∞—Å—ã",
        image: "images/Apple Watch Series 9/top1.webp",
        images: [
            "images/Apple Watch Series 9/top1.webp",
            "images/Apple Watch Series 9/215ac8ef49bd53c85de85905cca5833ea2bea88da6a357eab62f515bee6d902f.jpg.webp",
            "images/Apple Watch Series 9/308ee9825c35be43894b02cbf38f4d0395d0285a71a137d601bf4f0d75c073a1.jpg.webp",
            "images/Apple Watch Series 9/9cc3623da82fdcf44824d6ca19885c71349a4f1e55bf9eb72ea343a05e103d8d.jpg.webp",
            "images/Apple Watch Series 9/a58dcb74717a4602f11f12c6a03a281c7849f06b0a24108da18ec2273ca95445.jpg.webp",
            "images/Apple Watch Series 9/afd0a5817cca8508a5653c6e9b66afa693651a2545c39673464baf448d585db6.jpg.webp",
            "images/Apple Watch Series 9/f9a0fc2fa6bd6105c5e7f038f6781526278de79d2ef8a08e4344d217ee04ba18.jpg.webp"
        ],
        specs: [
            "–ß–∏–ø: Apple S9",
            "–î–∏—Å–ø–ª–µ–π: 45 –º–º Always-On Retina",
            "–ë–∞—Ç–∞—Ä–µ—è: –¥–æ 18 —á–∞—Å–æ–≤",
            "–î–∞–≤–ª–µ–Ω–∏–µ: IP6X, –≤–æ–¥–æ—Å—Ç–æ–π–∫–æ—Å—Ç—å 50–º",
            "–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: watchOS 10",
            "–î–∞—Ç—á–∏–∫–∏: GPS, –≠–ö–ì, –ø—É–ª—å—Å, SpO2"
        ],
        has3D: true,
        model3D: "models/Apple Watch Series 9/apple_watch_series_9.glb"
    },
    {
        id: 8,
        name: "Samsung Galaxy Watch 6",
        description: "–£–º–Ω—ã–µ —á–∞—Å—ã Samsung —Å AMOLED —ç–∫—Ä–∞–Ω–æ–º –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∑–¥–æ—Ä–æ–≤—å—è. –ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å –¥–æ 40 —á–∞—Å–æ–≤.",
        price: 24990,
        category: "–£–º–Ω—ã–µ —á–∞—Å—ã",
        image: "images/Samsung Galaxy Watch 6/top1.webp",
        images: [
            "images/Samsung Galaxy Watch 6/top1.webp",
            "images/Samsung Galaxy Watch 6/08a2ced8086a77ecc1997461856336b610f46dd2aa70d6dee1272d380c6982ed.jpg.webp",
            "images/Samsung Galaxy Watch 6/29e94d60e902cecb15035c65cadc69a29ed99bb3f6f30f14281690227117dd57.jpg.webp",
            "images/Samsung Galaxy Watch 6/569d377702f1bb84262e20428b50ef4ed92ecd8a40fd72f4397fa154c22c7a1b.jpg.webp",
            "images/Samsung Galaxy Watch 6/5e278f2c318bf9233cf06a6822f9cd46467e117d38ab1498685c52d1315d31e4.jpg.webp",
            "images/Samsung Galaxy Watch 6/c840ddbff827eb26f1077fb59298fa7dce10c71aa7b197e13d94341ce88e0d32.jpg.webp",
            "images/Samsung Galaxy Watch 6/e4649adeb5d562b38384024468def9bf764eec6ef7676b78fda3f118ab30c4f4.jpg.webp"
        ],
        specs: [
            "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: Exynos W930",
            "–î–∏—Å–ø–ª–µ–π: 40 –º–º Super AMOLED",
            "–ë–∞—Ç–∞—Ä–µ—è: –¥–æ 40 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
            "–ó–∞—â–∏—Ç–∞: IP68",
            "–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: WearOS 4",
            "–î–∞—Ç—á–∏–∫–∏: GPS, –≠–ö–ì, –ø—É–ª—å—Å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞"
        ],
        has3D: false
    },
    
    // –ö–ê–ë–ï–õ–ò
    {
        id: 9,
        name: "–ö–∞–±–µ–ª—å USB-C –Ω–∞ Lightning",
        description: "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–∞–±–µ–ª—å Apple –¥–ª–∏–Ω–æ–π 1 –º–µ—Ç—Ä. –ë—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö.",
        price: 1990,
        category: "–ö–∞–±–µ–ª–∏",
        image: "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ Lightning/top1.webp",
        images: [
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ Lightning/top1.webp",
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ Lightning/6013a219a9e43f143afeb847b4fa76241ec9cf704d7abecfbf483f2b50b5b4fd.jpg.webp",
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ Lightning/73222236c5d1dd37f4a28f63f904110af7d7bbe4421b180fd5440d373f14cb9f.jpg.webp",
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ Lightning/c962851c70f3c355975ccbc76316938226d7c5a240a1969fa6c203c368ff6df8.jpg.webp"
        ],
        specs: [
            "–î–ª–∏–Ω–∞: 1 –º–µ—Ç—Ä",
            "–¢–∏–ø: USB-C –Ω–∞ Lightning",
            "–°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏: –¥–æ 480 –ú–±–∏—Ç/—Å",
            "–ó–∞—Ä—è–¥–∫–∞: –±—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞",
            "–ì–∞—Ä–∞–Ω—Ç–∏—è: 1 –≥–æ–¥",
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: —É—Å—Ç–æ–π—á–∏–≤—ã–π –∫ –∏–∑–Ω–æ—Å—É"
        ],
        has3D: false
    },
    {
        id: 10,
        name: "–ö–∞–±–µ–ª—å USB-C –Ω–∞ USB-C",
        description: "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–∞–±–µ–ª—å Type-C –¥–ª–∏–Ω–æ–π 2 –º–µ—Ç—Ä–∞. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.",
        price: 1290,
        category: "–ö–∞–±–µ–ª–∏",
        image: "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ USB-C/top1.webp",
        images: [
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ USB-C/top1.webp",
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ USB-C/212c6f9c90caa7f6e1164dd5911c4e79b3902da7161cee2dbccf14ff7a8230d1.jpg.webp",
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ USB-C/8bef763d7155ca4dbd400fe04ef665f8e83f45c60197dfa95bd9fbc70e1666f8.jpg.webp",
            "images/–ö–∞–±–µ–ª—å USB-C –Ω–∞ USB-C/bc967f75de3c21d9be25ee532f7ffbba5a3fd07306fc09f963b403faf8727548.jpg.webp"
        ],
        specs: [
            "–î–ª–∏–Ω–∞: 2 –º–µ—Ç—Ä–∞",
            "–¢–∏–ø: USB-C –Ω–∞ USB-C",
            "–°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏: –¥–æ 10 –ì–±–∏—Ç/—Å",
            "–ó–∞—Ä—è–¥–∫–∞: Power Delivery 100W",
            "–ì–∞—Ä–∞–Ω—Ç–∏—è: 2 –≥–æ–¥–∞",
            "–ü–ª–µ—Ç–µ–Ω—ã–π –∫–∞–±–µ–ª—å: –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å"
        ],
        has3D: false
    },
    {
        id: 11,
        name: "–ö–∞–±–µ–ª—å Belkin Wireless Charger",
        description: "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è –∑–∞—Ä—è–¥–∫–∞ –Ω–∞ 15W –¥–ª—è iPhone –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ë—ã—Å—Ç—Ä–∞—è –∏ —É–¥–æ–±–Ω–∞—è.",
        price: 3490,
        category: "–ö–∞–±–µ–ª–∏",
        image: "images/–ö–∞–±–µ–ª—å Belkin Wireless Charger/top.webp",
        images: [
            "images/–ö–∞–±–µ–ª—å Belkin Wireless Charger/top.webp",
            "images/–ö–∞–±–µ–ª—å Belkin Wireless Charger/optimize.webp",
            "images/–ö–∞–±–µ–ª—å Belkin Wireless Charger/optimize (1).webp",
            "images/–ö–∞–±–µ–ª—å Belkin Wireless Charger/optimize (2).webp"
        ],
        specs: [
            "–ú–æ—â–Ω–æ—Å—Ç—å: 15W",
            "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: iPhone, Samsung, AirPods",
            "–†–∞–∑–º–µ—Ä—ã: 95 x 95 x 12 –º–º",
            "–ö–∞–±–µ–ª—å: USB-C 1.5 –º –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ",
            "–ó–∞—â–∏—Ç–∞: –æ—Ç –ø–µ—Ä–µ–≥—Ä–µ–≤–∞ –∏ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∑–∞–º—ã–∫–∞–Ω–∏—è",
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π –∫–æ—Ä–ø—É—Å"
        ],
        has3D: false
    },
    
    // –ß–ï–•–õ–´
    {
        id: 12,
        name: "–ß–µ—Ö–æ–ª Apple Silicone –¥–ª—è iPhone 15 Pro Max",
        description: "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∏–ª–∏–∫–æ–Ω–æ–≤—ã–π —á–µ—Ö–æ–ª Apple —Å –±–∞—Ä—Ö–∞—Ç–∏—Å—Ç–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å—é. –ò–¥–µ–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞.",
        price: 3990,
        category: "–ß–µ—Ö–ª—ã",
        image: "images/–ß–µ—Ö–æ–ª Apple Silicone –¥–ª—è iPhone 15 Pro Max/top1.webp",
        images: [
            "images/–ß–µ—Ö–æ–ª Apple Silicone –¥–ª—è iPhone 15 Pro Max/top1.webp",
            "images/–ß–µ—Ö–æ–ª Apple Silicone –¥–ª—è iPhone 15 Pro Max/5adc4b11981a250288a60b3adea867df49e1744272b5727424adbc2d4adf28fc.jpg.webp",
            "images/–ß–µ—Ö–æ–ª Apple Silicone –¥–ª—è iPhone 15 Pro Max/958486246e939a8d3b3e511bdeb56956fc42f2f0d6305cb6b16a1604c0323280.jpg.webp",
            "images/–ß–µ—Ö–æ–ª Apple Silicone –¥–ª—è iPhone 15 Pro Max/c7b5da212635473ce93743ee6c821cf266034a9616c34140fa103620f9026b71.jpg.webp"
        ],
        specs: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: —Å–∏–ª–∏–∫–æ–Ω –ø—Ä–µ–º–∏—É–º –∫–∞—á–µ—Å—Ç–≤–∞",
            "–ó–∞—â–∏—Ç–∞: —É–¥–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π –∏ –≥—Ä—è–∑–µ–æ—Ç—Ç–∞–ª–∫–∏–≤–∞—é—â–∏–π",
            "–¶–≤–µ—Ç–∞: 8 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤",
            "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: iPhone 15 Pro Max",
            "–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: –±–∞—Ä—Ö–∞—Ç–∏—Å—Ç–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å",
            "–ö–æ–º–ø–ª–µ–∫—Ç: –∑–∞—â–∏—Ç–Ω–∞—è –ø–ª–µ–Ω–∫–∞"
        ],
        has3D: false
    },
    {
        id: 13,
        name: "–ß–µ—Ö–æ–ª Samsung Clear View –¥–ª—è Galaxy S24",
        description: "–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —á–µ—Ö–æ–ª —Å –æ—Ç–∫–∏–¥–Ω–æ–π –∫—Ä—ã—à–∫–æ–π –¥–ª—è Galaxy S24. –ö–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –∑–∞—â–∏—Ç–∞ —ç–∫—Ä–∞–Ω–∞.",
        price: 3490,
        category: "–ß–µ—Ö–ª—ã",
        image: "images/–ß–µ—Ö–æ–ª Samsung Clear View –¥–ª—è Galaxy S24/top1.webp",
        images: [
            "images/–ß–µ—Ö–æ–ª Samsung Clear View –¥–ª—è Galaxy S24/top1.webp",
            "images/–ß–µ—Ö–æ–ª Samsung Clear View –¥–ª—è Galaxy S24/28aeb4ae6e72ec29f7b91328656c2559d2aa6708f13d5221cc5966e1ead39c45.jpg.webp",
            "images/–ß–µ—Ö–æ–ª Samsung Clear View –¥–ª—è Galaxy S24/e6f232a27569e891e01b05e86f3857642362078f4c4507dcc1c8d1161e059e2b.jpg.webp"
        ],
        specs: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –ü–í–•",
            "–ó–∞—â–∏—Ç–∞: –æ—Ç —É–¥–∞—Ä–æ–≤ –∏ —Ü–∞—Ä–∞–ø–∏–Ω",
            "–û—Ç–∫–∏–¥–Ω–∞—è –∫—Ä—ã—à–∫–∞: S-View –¥–∏—Å–ø–ª–µ–π",
            "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: Galaxy S24 Ultra",
            "–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: –¥–µ—Ä–∂–∞—Ç–µ–ª—å –¥–ª—è –∫–∞—Ä—Ç",
            "–î–∏–∑–∞–π–Ω: –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π, –±–µ—Å—Ü–≤–µ—Ç–Ω—ã–π"
        ],
        has3D: false
    },
    {
        id: 14,
        name: "–ß–µ—Ö–æ–ª Spigen Ultra Hybrid",
        description: "–ó–∞—â–∏—Ç–Ω—ã–π —á–µ—Ö–æ–ª —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π —Å–ø–∏–Ω–∫–æ–π –∏ –∞—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —É–≥–ª–∞–º–∏. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∑–∞–π–Ω —Ç–µ–ª–µ—Ñ–æ–Ω–∞.",
        price: 2490,
        category: "–ß–µ—Ö–ª—ã",
        image: "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/top1.webp",
        images: [
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/top1.webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize.webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize (1).webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize (2).webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize (3).webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize (4).webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize (5).webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize (6).webp",
            "images/–ß–µ—Ö–æ–ª Spigen Ultra Hybrid/optimize (7).webp"
        ],
        specs: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π TPU",
            "–ó–∞—â–∏—Ç–∞: –∞—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É–≥–ª—ã Air Cushion",
            "–†–∞–º–∫–∞: –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ü–≤–µ—Ç–Ω–∞—è",
            "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: –≤—Å–µ –º–æ–¥–µ–ª–∏ iPhone/Samsung",
            "–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å: –∞–Ω—Ç–∏-–æ—Ç–ø–µ—á–∞—Ç–∫–∏",
            "–î–∏–∑–∞–π–Ω: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∑–∞–π–Ω —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
        ],
        has3D: false
    },
    
    // –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ê–ö–°–ï–°–°–£–ê–†–´
    {
        id: 15,
        name: "–ó–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ –¥–ª—è iPhone 15 Pro Max",
        description: "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∑–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ Apple —Å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–µ–π Ceramic Shield. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ —ç–∫—Ä–∞–Ω–∞.",
        price: 2990,
        category: "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã",
        image: "images/–ó–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ –¥–ª—è iPhone 15 Pro Max/top1.webp",
        images: [
            "images/–ó–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ –¥–ª—è iPhone 15 Pro Max/top1.webp",
            "images/–ó–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ –¥–ª—è iPhone 15 Pro Max/3de7c1b85d1ec459d43ad1eccc7fbc739de4f5a650900564030f9252e89f4c79.jpg.webp",
            "images/–ó–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ –¥–ª—è iPhone 15 Pro Max/da1c69e87ec99fc0289d3c79cd0a9e078ecdf14994be12354af99a44c27cc1a5.jpg.webp",
            "images/–ó–∞—â–∏—Ç–Ω–æ–µ —Å—Ç–µ–∫–ª–æ –¥–ª—è iPhone 15 Pro Max/fbcc0581b4342ec22c87f8ad4545de52c7ee0fd4683e863545bce1d224b65bba.jpg.webp"
        ],
        specs: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: Ceramic Shield",
            "–ó–∞—â–∏—Ç–∞: –æ—Ç —Ü–∞—Ä–∞–ø–∏–Ω –∏ —É–¥–∞—Ä–æ–≤",
            "–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å: 99.9%",
            "–¢–æ–ª—â–∏–Ω–∞: 0.3 –º–º",
            "–¶–≤–µ—Ç: –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–µ",
            "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: –≤—Å–µ –º–æ–¥–µ–ª–∏ iPhone"
        ],
        has3D: false
    },
    {
        id: 16,
        name: "–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K",
        description: "–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π powerbank –Ω–∞ 10000 –º–ê—á —Å –±—ã—Å—Ç—Ä–æ–π –∑–∞—Ä—è–¥–∫–æ–π. –ó–∞—Ä—è–∂–∞–π—Ç–µ –≥–∞–¥–∂–µ—Ç—ã –≤ –¥–æ—Ä–æ–≥–µ.",
        price: 4990,
        category: "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã",
        image: "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/top1.webp",
        images: [
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/top1.webp",
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/62bc39e276febdbe8aa1272a03a259c10106f29957a3e66211294127b2aa5ec6.jpg.webp",
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/a4bd0e41db0f408ad9a0047c4e101886618f12b33496600a8132cde12b8ab685.jpg.webp",
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/c64b8a7184178b7391e2733fbcb021d14bb8f0fa5543dbb248237d75ab4882fe.jpg.webp",
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/c7dea9b8a79f8797d58150e8338d3437e2881bb55ba56e6d5411c0cc3a142f26.jpg.webp",
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/d3565a03de966a3d3992c7f4726fcd9ed49f50b0fec26199f0b1964cb19877d8.jpg.webp",
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/dd44181431179b39c6265f945b57efbb1c1d2b011a3dfb6db6a1d84dc79d521c.jpg.webp",
            "images/–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ Belkin 10K/efcb3ab67ab8df96732d8f1a1a3bef0df04919b782550f1cd388ac8691ba61cd.jpg.webp"
        ],
        specs: [
            "–ï–º–∫–æ—Å—Ç—å: 10000 –º–ê—á",
            "–í—ã—Ö–æ–¥: USB-C 18W + USB-A 15W",
            "–í—Ö–æ–¥: USB-C",
            "–†–∞–∑–º–µ—Ä—ã: 113 x 58 x 23 –º–º",
            "–í–µ—Å: 200 –≥",
            "–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏: –±—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞ Power Delivery"
        ],
        has3D: false
    }
];

// –ö–æ—Ä–∑–∏–Ω–∞
let cart = JSON.parse(localStorage.getItem('cart')) || [];

// –ê–¥–º–∏–Ω —Ä–µ–∂–∏–º
// –°–µ–∫—Ä–µ—Ç–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
const ADMIN_PASSWORD = 'admin2024';
let isAdmin = localStorage.getItem('adminMode') === 'true';
let isAdminAuthorized = localStorage.getItem('adminAuthorized') === 'true';

// –¢–µ–∫—É—â–∞—è –≤—ã–±—Ä–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
let currentCategory = 'all';

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ü–µ–Ω–µ
let minPrice = 0;
let maxPrice = 500000;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
window.addEventListener('DOMContentLoaded', async () => {
    // –í—ã—á–∏—Å–ª—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –¥–ª—è —Å–ª–∞–π–¥–µ—Ä–∞
    const maxProductPrice = Math.max(...products.map(p => p.price));
    const calculatedMaxPrice = Math.ceil(maxProductPrice / 10000) * 10000; // –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ 10000
    maxPrice = calculatedMaxPrice;
    
    const priceSliderMin = document.getElementById('priceSliderMin');
    const priceSliderMax = document.getElementById('priceSliderMax');
    if (priceSliderMin && priceSliderMax) {
        priceSliderMin.max = calculatedMaxPrice;
        priceSliderMax.max = calculatedMaxPrice;
        priceSliderMin.value = minPrice;
        priceSliderMax.value = maxPrice;
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª–∑—É–Ω–∫–æ–≤
        setupDualSlider();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
        setTimeout(() => {
            updateTrackRange();
        }, 100);
    }
    const priceDisplay = document.getElementById('priceRange');
    if (priceDisplay) {
        priceDisplay.textContent = `${minPrice.toLocaleString()} ‚ÇΩ - ${maxPrice.toLocaleString()} ‚ÇΩ`;
    }
    
    renderProducts();
    renderCart();
    updateCartCount();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Google Pay –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    initGooglePay();
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('payment') === 'success') {
        // –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–µ
        const orderData = JSON.parse(localStorage.getItem('pendingOrder') || '{}');
        if (orderData.paid) {
            showNotification('‚úÖ –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.', 'success');
            // –û—á–∏—â–∞–µ–º pendingOrder
            localStorage.removeItem('pendingOrder');
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—Ä–∑–∏–Ω—É (–æ–Ω–∞ —É–∂–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—á–∏—â–µ–Ω–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–ø–ª–∞—Ç—ã)
            cart = [];
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
            updateCartCount();
            // –£–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–∑ URL
            window.history.replaceState({}, document.title, window.location.pathname);
        }
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∞–¥–º–∏–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    // –ö–Ω–æ–ø–∫–∞ ADMIN –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ HTML
    initAdminMode();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º IndexedDB
    try {
        db = await initDB();
        console.log('‚úÖ IndexedDB –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
    } catch (err) {
        console.error('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ IndexedDB:', err);
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–ª–∞–π–¥–µ—Ä—ã
    initSliders();
});



// –°–µ–∫—Ä–µ—Ç–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∫–ª–∞–≤–∏—à –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: Ctrl+Shift+A
document.addEventListener('keydown', (e) => {
    if (e.ctrlKey && e.shiftKey && e.key === 'A') {
        e.preventDefault();
        if (!isAdminAuthorized) {
            showAdminLogin();
        }
    }
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω —Ä–µ–∂–∏–º–∞
function initAdminMode() {
    const adminToggle = document.getElementById('adminToggle');
    const adminBtn = document.getElementById('adminUploadBtn');
    const clearBtn = document.getElementById('adminClearBtn');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É ADMIN —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
    if (isAdminAuthorized && adminToggle) {
        adminToggle.style.display = 'flex';
    } else if (adminToggle) {
        adminToggle.style.display = 'none';
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω
    if (isAdmin && isAdminAuthorized) {
        if (adminBtn) adminBtn.style.display = 'inline-block';
        if (clearBtn) clearBtn.style.display = 'inline-block';
    } else {
        if (adminBtn) adminBtn.style.display = 'none';
        if (clearBtn) clearBtn.style.display = 'none';
    }
}

// –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è
function showAdminLogin() {
    // –ï—Å–ª–∏ —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º
    if (isAdminAuthorized) {
        toggleAdminMode();
        return;
    }
    
    const password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:');
    if (password === ADMIN_PASSWORD) {
        isAdminAuthorized = true;
        localStorage.setItem('adminAuthorized', 'true');
        showNotification('‚úÖ –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –ø–æ–ª—É—á–µ–Ω');
        initAdminMode();
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ–º –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        isAdmin = true;
        localStorage.setItem('adminMode', 'true');
        initAdminMode();
    } else if (password !== null) {
        showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
    }
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω —Ä–µ–∂–∏–º–∞
function toggleAdminMode() {
    if (!isAdminAuthorized) {
        showAdminLogin();
        return;
    }
    
    isAdmin = !isAdmin;
    localStorage.setItem('adminMode', isAdmin.toString());
    initAdminMode();
    
    if (isAdmin) {
        showNotification('üîß –ê–¥–º–∏–Ω —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω');
    } else {
        showNotification('üë§ –ê–¥–º–∏–Ω —Ä–µ–∂–∏–º –≤—ã–∫–ª—é—á–µ–Ω');
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (–º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å)
function logoutAdmin() {
    isAdminAuthorized = false;
    isAdmin = false;
    localStorage.removeItem('adminAuthorized');
    localStorage.removeItem('adminMode');
    showNotification('üëã –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏');
    initAdminMode();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è IndexedDB –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
let db = null;
// –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è blob URLs (—á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å –ø–∞–º—è—Ç—å)
const activeBlobUrls = new Set();

function initDB() {
    return new Promise((resolve, reject) => {
        const request = indexedDB.open('3dModelsDB', 1);
        
        request.onerror = () => reject(request.error);
        request.onsuccess = () => {
            db = request.result;
            resolve(db);
        };
        
        request.onupgradeneeded = (event) => {
            const db = event.target.result;
            if (!db.objectStoreNames.contains('models')) {
                db.createObjectStore('models', { keyPath: 'productId' });
            }
        };
    });
}

// –ó–∞–≥—Ä—É–∑–∫–∞ 3D –º–æ–¥–µ–ª–∏
function upload3DModel(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    let currentProductId = getCurrentProductId();
    
    // –ï—Å–ª–∏ productId –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    if (!currentProductId) {
        currentProductId = window.currentProductId;
    }
    
    // –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
    if (!currentProductId) {
        alert('‚ùå –ù–µ –≤—ã–±—Ä–∞–Ω —Ç–æ–≤–∞—Ä. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–æ–≤–∞—Ä –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –∏ –∑–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ 3D –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –º–æ–¥–µ–ª–∏.');
        console.error('currentProductId –Ω–µ –Ω–∞–π–¥–µ–Ω. –î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:', {
            windowCurrentProductId: window.currentProductId,
            modalOpen: document.getElementById('productModal')?.style.display,
            viewerOpen: document.getElementById('viewer3DModal')?.style.display
        });
        return;
    }
    
    console.log('üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ID:', currentProductId);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä (–º–∞–∫—Å 50MB –¥–ª—è IndexedDB)
    if (file.size > 50 * 1024 * 1024) {
        alert('‚ö†Ô∏è –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π! –ú–∞–∫—Å–∏–º—É–º 50MB');
        return;
    }
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                     (window.innerWidth <= 768 && window.innerHeight <= 1024);
    
    console.log('üì± –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–∞', isMobile ? '–º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ' : '–¥–µ—Å–∫—Ç–æ–ø–µ');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º DB –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    const initPromise = db ? Promise.resolve(db) : initDB();
    
    initPromise.then(() => {
        if (!db) {
            console.error('‚ùå IndexedDB –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–º–∏—Å–∞');
            alert('‚ùå –û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö');
            return;
        }
        
        console.log('üìÇ –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, —Ä–∞–∑–º–µ—Ä:', file.size, '–±–∞–π—Ç');
        
        // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –∫–∞–∫ ArrayBuffer –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const arrayBuffer = e.target.result;
            console.log('‚úÖ –§–∞–π–ª –ø—Ä–æ—á–∏—Ç–∞–Ω, —Ä–∞–∑–º–µ—Ä ArrayBuffer:', arrayBuffer.byteLength, '–±–∞–π—Ç');
            
            // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –¥–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
            const saveDelay = isMobile ? 100 : 0;
            
            setTimeout(() => {
                try {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ IndexedDB
                    const transaction = db.transaction(['models'], 'readwrite');
                    const store = transaction.objectStore('models');
                    
                    const record = {
                        productId: currentProductId,
                        model: arrayBuffer,
                        timestamp: Date.now()
                    };
                    
                    console.log('üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–æ–¥–µ–ª—å –≤ IndexedDB –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ID:', currentProductId);
                    
                    const request = store.put(record);
                    
                    request.onsuccess = () => {
                        console.log('‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ IndexedDB:', {
                            productId: currentProductId,
                            fileSize: file.size,
                            arrayBufferSize: arrayBuffer.byteLength,
                            timestamp: new Date(record.timestamp).toLocaleString('ru-RU'),
                            device: isMobile ? 'mobile' : 'desktop'
                        });
                        
                        // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π
                        const verifyDelay = isMobile ? 200 : 100;
                        
                        setTimeout(() => {
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∑–∞–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
                            const verifyTransaction = db.transaction(['models'], 'readonly');
                            const verifyStore = verifyTransaction.objectStore('models');
                            const verifyRequest = verifyStore.get(currentProductId);
                            
                            verifyRequest.onsuccess = () => {
                                if (verifyRequest.result && verifyRequest.result.model) {
                                    console.log('‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ: –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ID', currentProductId, '—Ä–∞–∑–º–µ—Ä:', verifyRequest.result.model.byteLength, '–±–∞–π—Ç');
                                } else {
                                    console.error('‚ùå –û–®–ò–ë–ö–ê: –ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ IndexedDB –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!');
                                }
                            };
                            
                            verifyRequest.onerror = () => {
                                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', verifyRequest.error);
                            };
                        }, verifyDelay);
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ viewer
                        const modelViewer = document.getElementById('model-viewer');
                        if (modelViewer) {
                            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ blob URLs
                            clearBlobUrls();
                            
                            // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º blob
                            const viewerDelay = isMobile ? 150 : 50;
                            
                            setTimeout(() => {
                                try {
                                    // –°–æ–∑–¥–∞–µ–º blob URL –∏–∑ ArrayBuffer
                                    const blob = new Blob([arrayBuffer], { type: 'application/octet-stream' });
                                    const blobUrl = URL.createObjectURL(blob);
                                    activeBlobUrls.add(blobUrl);
                                    modelViewer.src = blobUrl;
                                    console.log('‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ viewer, URL:', blobUrl.substring(0, 50) + '...');
                                    showNotification(`‚úÖ 3D –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ (—Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ). –î–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ GitHub.`, 'success');
                                } catch (blobError) {
                                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è blob –¥–ª—è viewer:', blobError);
                                    showNotification('‚úÖ –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞, –Ω–æ –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä', 'warning');
                                }
                            }, viewerDelay);
                        } else {
                            console.warn('‚ö†Ô∏è model-viewer –Ω–µ –Ω–∞–π–¥–µ–Ω, –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –Ω–æ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä');
                            showNotification(`‚úÖ –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ (—Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ). –î–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ GitHub.`, 'success');
                        }
                    };
                    
                    request.onerror = () => {
                        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ IndexedDB:', request.error);
                        alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + (request.error?.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                    };
                } catch (saveError) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:', saveError);
                    alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                }
            }, saveDelay);
        };
        
        reader.onerror = function(error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞:', error);
            alert('‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞');
        };
        
        reader.readAsArrayBuffer(file);
    }).catch(err => {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ DB:', err);
        alert('‚ùå –û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: ' + (err?.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
    });
}

// –ü–æ–ª—É—á–∞–µ–º ID —Ç–µ–∫—É—â–µ–≥–æ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
function getCurrentProductId() {
    // –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–∫—Ä—ã—Ç—ã–π ID –∏–∑ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏–ª–∏ cookie
    return window.currentProductId || null;
}

// –û—á–∏—Å—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö 3D –º–æ–¥–µ–ª–µ–π
function clearSaved3DModels() {
    if (!db) {
        showNotification('‚ö†Ô∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
        return;
    }
    
    const transaction = db.transaction(['models'], 'readwrite');
    const store = transaction.objectStore('models');
    const request = store.clear();
    
    request.onsuccess = () => {
        showNotification('üóëÔ∏è –í—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ 3D –º–æ–¥–µ–ª–∏ —É–¥–∞–ª–µ–Ω—ã');
        console.log('IndexedDB –æ—á–∏—â–µ–Ω–∞');
    };
    
    request.onerror = () => {
        showNotification('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
        console.error('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ IndexedDB:', request.error);
    };
}

// –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ç–µ–∫—É—â–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
const currentImageIndex = {};

// –•—Ä–∞–Ω–∏–ª–∏—â–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
const currentProductColor = {};

// –†–µ–Ω–¥–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤
function renderProducts() {
    // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    let filteredProducts = products;
    if (currentCategory !== 'all') {
        filteredProducts = products.filter(p => p.category === currentCategory);
    }
    
    // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ —Ü–µ–Ω–µ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º –∏ –º–∞–∫—Å–∏–º—É–º
    const actualMin = Math.min(minPrice, maxPrice);
    const actualMax = Math.max(minPrice, maxPrice);
    filteredProducts = filteredProducts.filter(p => p.price >= actualMin && p.price <= actualMax);
    
    const grid = document.getElementById('productsGrid');
    grid.innerHTML = filteredProducts.map(product => {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
        if (!currentImageIndex[product.id]) {
            currentImageIndex[product.id] = 0;
        }
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
        let productImages = product.images;
        let productImage = product.image;
        if (product.hasColors && product.colors) {
            // –î–ª—è iPhone 15 Pro Max –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±–∏—Ä–∞–µ–º "–ß–µ—Ä–Ω—ã–π"
            let defaultColor = product.id === 1 && product.colors["–ß–µ—Ä–Ω—ã–π"] ? "–ß–µ—Ä–Ω—ã–π" : Object.keys(product.colors)[0];
            
            const selectedColor = currentProductColor[product.id] || defaultColor;
            productImages = product.colors[selectedColor].images;
            productImage = product.colors[selectedColor].image;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
            if (!currentProductColor[product.id]) {
                currentProductColor[product.id] = selectedColor;
            }
        }
        
        return `
            <div class="product-card">
                <div class="product-images-container">
                    ${productImages && productImages.length > 1 ? `
                        <div class="product-images" id="images-${product.id}" onwheel="handleProductScroll(event, ${product.id})" ontouchstart="handleTouchStart(event)" ontouchend="handleTouchEnd(event, ${product.id}, false)">
                            ${productImages.map((img, idx) => `
                                <img src="${img}" alt="${product.name}" class="product-image">
                            `).join('')}
                        </div>
                        <button class="product-arrow product-arrow-left" onclick="navigateProductImage(${product.id}, -1); event.stopPropagation();">‚ùÆ</button>
                        <button class="product-arrow product-arrow-right" onclick="navigateProductImage(${product.id}, 1); event.stopPropagation();">‚ùØ</button>
                    ` : `
                        <img src="${productImage}" alt="${product.name}" class="product-image">
                    `}
                </div>
                <div class="product-info" onclick="openModal(${product.id})">
                    <h3>${product.name}</h3>
                    <p>${product.description.substring(0, 80)}...</p>
                    <div class="product-price">${product.price.toLocaleString()} ‚ÇΩ</div>
                </div>
            </div>
        `;
    }).join('');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏–∏ –≤—Å–µ—Ö –∫–∞—Ä—É—Å–µ–ª–µ–π
    filteredProducts.forEach(product => {
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
        let productImages = product.images;
        if (product.hasColors && product.colors) {
            // –î–ª—è iPhone 15 Pro Max –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±–∏—Ä–∞–µ–º "–ß–µ—Ä–Ω—ã–π"
            let defaultColor = product.id === 1 && product.colors["–ß–µ—Ä–Ω—ã–π"] ? "–ß–µ—Ä–Ω—ã–π" : Object.keys(product.colors)[0];
            
            const selectedColor = currentProductColor[product.id] || defaultColor;
            productImages = product.colors[selectedColor].images;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
            if (!currentProductColor[product.id]) {
                currentProductColor[product.id] = selectedColor;
            }
        }
        
        if (productImages && productImages.length > 1) {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–∞—Ä—É—Å–µ–ª–∏ –ø–æ—Å–ª–µ –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
            setTimeout(() => {
                updateCarouselPosition(product.id);
            }, 100);
        }
    });
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –∫–∞—Ä—É—Å–µ–ª–∏ –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∞
    setTimeout(() => {
        filteredProducts.forEach(product => {
            if (document.getElementById(`images-${product.id}`)) {
                updateCarouselPosition(product.id);
            }
        });
    }, 200);
}

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
function filterProducts(category) {
    currentCategory = category;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    if (event && event.target) {
        event.target.classList.add('active');
    }
    
    // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–æ–≤–∞—Ä—ã
    renderProducts();
}

// Debounce –¥–ª—è –ø–ª–∞–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
let priceFilterTimeout;
function debouncePriceFilter() {
    clearTimeout(priceFilterTimeout);
    priceFilterTimeout = setTimeout(() => {
        renderProducts();
    }, 150);
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–≤–æ–π–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞ - –æ–±–µ —Ç–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
function setupDualSlider() {
    const sliderMin = document.getElementById('priceSliderMin');
    const sliderMax = document.getElementById('priceSliderMax');
    const container = document.getElementById('dualRangeSlider');
    
    if (!sliderMin || !sliderMax || !container) return;
    
    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–ª–∏–∫–∏ –ø–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –∏ —Ç—Ä–µ–∫—É
    container.style.pointerEvents = 'none';
    
    // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Å–ª–∞–π–¥–µ—Ä—ã –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–æ–±—ã—Ç–∏—è
    sliderMin.style.pointerEvents = 'auto';
    sliderMax.style.pointerEvents = 'auto';
    sliderMin.style.zIndex = '5';
    sliderMax.style.zIndex = '6'; // –ü—Ä–∞–≤–∞—è —Ç–æ—á–∫–∞ –≤—ã—à–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ª–µ–≤—ã–º —Å–ª–∞–π–¥–µ—Ä–æ–º - —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ–º z-index
    const handleMinInteraction = (e) => {
        sliderMin.style.zIndex = '10';
        sliderMax.style.zIndex = '6';
    };
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–∞–≤—ã–º —Å–ª–∞–π–¥–µ—Ä–æ–º - —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ–º z-index
    const handleMaxInteraction = (e) => {
        sliderMax.style.zIndex = '10';
        sliderMin.style.zIndex = '5';
    };
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ª–µ–≤–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞ - —Ç–æ–ª—å–∫–æ –¥–ª—è z-index
    sliderMin.addEventListener('mousedown', handleMinInteraction);
    sliderMin.addEventListener('touchstart', handleMinInteraction);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–∞–≤–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞ - —Ç–æ–ª—å–∫–æ –¥–ª—è z-index
    sliderMax.addEventListener('mousedown', handleMaxInteraction);
    sliderMax.addEventListener('touchstart', handleMaxInteraction);
    
    // –î–æ–±–∞–≤–ª—è–µ–º —è–≤–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ input –∏ change –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã
    sliderMin.addEventListener('input', function(e) {
        updatePriceFilter('min', this.value);
    });
    sliderMin.addEventListener('change', function(e) {
        updatePriceFilter('min', this.value);
    });
    
    sliderMax.addEventListener('input', function(e) {
        updatePriceFilter('max', this.value);
    });
    sliderMax.addEventListener('change', function(e) {
        updatePriceFilter('max', this.value);
    });
    
    // –í–æ–∑–≤—Ä–∞—Ç z-index –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
    const resetZIndex = () => {
        sliderMin.style.zIndex = '5';
        sliderMax.style.zIndex = '6';
    };
    
    document.addEventListener('mouseup', resetZIndex);
    document.addEventListener('touchend', resetZIndex);
    document.addEventListener('mouseleave', resetZIndex);
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
function updateTrackRange() {
    const sliderMin = document.getElementById('priceSliderMin');
    const sliderMax = document.getElementById('priceSliderMax');
    const track = document.querySelector('.price-slider-track');
    
    if (!sliderMin || !sliderMax || !track) return;
    
    const minValue = parseInt(sliderMin.value);
    const maxValue = parseInt(sliderMax.value);
    const sliderMaxValue = parseInt(sliderMax.max);
    
    // –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è, –±–æ–ª—å—à–µ–µ –¥–ª—è –ø—Ä–∞–≤–æ–≥–æ
    const actualMin = Math.min(minValue, maxValue);
    const actualMax = Math.max(minValue, maxValue);
    
    const leftPercent = (actualMin / sliderMaxValue) * 100;
    const rightPercent = (actualMax / sliderMaxValue) * 100;
    
    track.style.setProperty('--track-left', `${leftPercent}%`);
    track.style.setProperty('--track-right', `${rightPercent}%`);
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ —Ü–µ–Ω–µ
// –¢–æ—á–∫–∞ –ê (min) –∏ –¢–æ—á–∫–∞ –ë (max) —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
function updatePriceFilter(type, value) {
    const sliderMin = document.getElementById('priceSliderMin');
    const sliderMax = document.getElementById('priceSliderMax');
    
    if (!sliderMin || !sliderMax) return;
    
    const newValue = parseInt(value);
    
    // –¢–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ - –Ω–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    if (type === 'min') {
        minPrice = newValue;
    } else if (type === 'max') {
        maxPrice = newValue;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    updateTrackRange();
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º –∏ –º–∞–∫—Å–∏–º—É–º –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    const actualMin = Math.min(minPrice, maxPrice);
    const actualMax = Math.max(minPrice, maxPrice);
    
    const priceDisplay = document.getElementById('priceRange');
    if (priceDisplay) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –æ—Ç –º–µ–Ω—å—à–µ–≥–æ –∫ –±–æ–ª—å—à–µ–º—É
        priceDisplay.textContent = `–æ—Ç ${actualMin.toLocaleString()} ‚ÇΩ - –¥–æ ${actualMax.toLocaleString()} ‚ÇΩ`;
    }
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º debounce –¥–ª—è –ø–ª–∞–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    debouncePriceFilter();
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ Trade-in
function openTradeIn(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è Trade-in: 30% –æ—Ç —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–∞
    const minTradeInValue = Math.round(product.price * 0.3);
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    window.minTradeInValue = minTradeInValue;
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–¥—É–∫—Ç–µ
    document.getElementById('tradeinProductName').textContent = product.name;
    document.getElementById('tradeinProductPrice').textContent = `${product.price.toLocaleString()} ‚ÇΩ`;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏
    const minValueElement = document.getElementById('tradeinMinValue');
    if (minValueElement) {
        minValueElement.textContent = `${minTradeInValue.toLocaleString()} ‚ÇΩ`;
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
    window.currentTradeInProductId = productId;
    
    // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    const devicePriceInput = document.getElementById('tradeinDevicePrice');
    if (devicePriceInput) {
        devicePriceInput.value = '';
        devicePriceInput.min = minTradeInValue;
    }
    
    // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    const modal = document.getElementById('tradeInModal');
    if (modal) {
        modal.style.display = 'block';
    }
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ Trade-in
function closeTradeInModal() {
    const modal = document.getElementById('tradeInModal');
    if (modal) {
        modal.style.display = 'none';
    }
    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    const form = document.getElementById('tradeInForm');
    if (form) {
        form.reset();
    }
    // –û—á–∏—â–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π ID –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    if (window.currentTradeInProductId) {
        delete window.currentTradeInProductId;
    }
    if (window.minTradeInValue) {
        delete window.minTradeInValue;
    }
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ Trade-in
function submitTradeIn(event) {
    event.preventDefault();
    
    if (!window.currentTradeInProductId) {
        showNotification('–û—à–∏–±–∫–∞: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.', 'error');
        return;
    }
    
    const product = products.find(p => p.id === window.currentTradeInProductId);
    if (!product) {
        showNotification('–û—à–∏–±–∫–∞: —Ç–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.', 'error');
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (30% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞)
    const minTradeInValue = window.minTradeInValue || Math.round(product.price * 0.3);
    
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
    const name = document.getElementById('tradeinName').value;
    const phone = document.getElementById('tradeinPhone').value;
    const email = document.getElementById('tradeinEmail').value;
    const device = document.getElementById('tradeinDevice').value;
    const devicePriceInput = document.getElementById('tradeinDevicePrice');
    const tradeInValue = parseInt(devicePriceInput.value) || 0;
    const condition = document.getElementById('tradeinCondition').value;
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è: —Å—Ç–æ–∏–º–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 30% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞
    if (tradeInValue < minTradeInValue) {
        showNotification(`–û—à–∏–±–∫–∞: —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ ${minTradeInValue.toLocaleString()} ‚ÇΩ (30% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞).`, 'error');
        return;
    }
    
    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    console.log('Trade-in –∑–∞—è–≤–ª–µ–Ω–∏–µ:', {
        productId: window.currentTradeInProductId,
        productName: product.name,
        name,
        phone,
        email,
        device,
        devicePrice: tradeInValue,
        condition
    });
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    closeTradeInModal();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
    showNotification('‚úÖ –ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ Trade-in —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.', 'success');
}

// –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ —Ç–æ–≤–∞—Ä–∞
function selectColor(productId, color) {
    currentProductColor[productId] = color;
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ —Å–º–µ–Ω–µ —Ü–≤–µ—Ç–∞
    currentImageIndex[productId] = 0;
    
    // –ï—Å–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ, –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –µ–≥–æ
    const modal = document.getElementById('productModal');
    if (modal && modal.style.display === 'block' && window.currentProductId === productId) {
        openModal(productId);
    } else {
        // –ò–Ω–∞—á–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–æ–≤–∞—Ä—ã
        renderProducts();
    }
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∫–∞—Ä—É—Å–µ–ª–∏
function updateCarouselPosition(productId, withBounce = false) {
    const container = document.getElementById(`images-${productId}`);
    if (!container) return;
    
    const index = currentImageIndex[productId] || 0;
    const product = products.find(p => p.id === productId);
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
    let imagesArray = product.images;
    if (product.hasColors && product.colors) {
        // –î–ª—è iPhone 15 Pro Max –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±–∏—Ä–∞–µ–º "–ß–µ—Ä–Ω—ã–π"
        const defaultColor = productId === 1 && product.colors["–ß–µ—Ä–Ω—ã–π"] ? "–ß–µ—Ä–Ω—ã–π" : Object.keys(product.colors)[0];
        const selectedColor = currentProductColor[productId] || defaultColor;
        imagesArray = product.colors[selectedColor].images;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
        if (!currentProductColor[productId]) {
            currentProductColor[productId] = selectedColor;
        }
    }
    const maxIndex = imagesArray ? imagesArray.length - 1 : 0;
    
    let offset = -index * 100;
    
    // –≠—Ñ—Ñ–µ–∫—Ç "–±—É—Ñ–µ—Ä–∞" –Ω–∞ –∫—Ä–∞—è—Ö
    if (withBounce) {
        if (index < 0) {
            offset = -index * 10; // –ü—Ä—É–∂–∏–Ω—è—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç –≤–ª–µ–≤–æ
        } else if (index > maxIndex) {
            offset = -(maxIndex * 100 + (index - maxIndex) * 10); // –ü—Ä—É–∂–∏–Ω—è—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç –≤–ø—Ä–∞–≤–æ
        }
    }
    
    container.style.transform = `translateX(${offset}%)`;
    
    // –í–æ–∑–≤—Ä–∞—Ç –∫ –≥—Ä–∞–Ω–∏—Ü–µ –µ—Å–ª–∏ –±—ã–ª —ç—Ñ—Ñ–µ–∫—Ç –±—É—Ñ–µ—Ä–∞
    if (withBounce) {
        setTimeout(() => {
            if (currentImageIndex[productId] < 0) currentImageIndex[productId] = 0;
            if (currentImageIndex[productId] > maxIndex) currentImageIndex[productId] = maxIndex;
            updateCarouselPosition(productId);
        }, 300);
    }
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Ç–æ–≤–∞—Ä–æ–≤
function handleProductScroll(event, productId) {
    event.preventDefault();
    event.stopPropagation();
    
    const delta = event.deltaY > 0 ? 1 : -1;
    navigateProductImage(productId, delta);
}

// –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º —Å—Ç—Ä–µ–ª–∫–∞–º–∏
function navigateProductImage(productId, direction) {
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
    let imagesArray = product.images;
    if (product.hasColors && product.colors) {
        const selectedColor = currentProductColor[productId] || Object.keys(product.colors)[0];
        imagesArray = product.colors[selectedColor].images;
    }
    
    if (!imagesArray) return;
    
    const maxIndex = imagesArray.length - 1;
    let newIndex = currentImageIndex[productId] + direction;
    
    currentImageIndex[productId] = newIndex;
    
    // –î–∞–µ–º —Å–¥–≤–∏–Ω—É—Ç—å –Ω–æ –ø–æ—Ç–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ—Å–ª–∏ –≤—ã—à–ª–∏ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã
    if (newIndex < 0 || newIndex > maxIndex) {
        updateCarouselPosition(productId, true); // –° –±—É—Ñ–µ—Ä–æ–º
    } else {
        updateCarouselPosition(productId); // –ë–µ–∑ –±—É—Ñ–µ—Ä–∞
    }
}

// Touch –∂–µ—Å—Ç—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
let touchStartX = 0;
let touchStartY = 0;
let touchEndX = 0;
let touchEndY = 0;

function handleTouchStart(event) {
    touchStartX = event.changedTouches[0].screenX;
    touchStartY = event.changedTouches[0].screenY;
}

function handleTouchEnd(event, productId, isModal = false) {
    touchEndX = event.changedTouches[0].screenX;
    touchEndY = event.changedTouches[0].screenY;
    
    const deltaX = touchStartX - touchEndX;
    const deltaY = touchStartY - touchEndY;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —ç—Ç–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø (–Ω–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª)
    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
        if (deltaX > 0) {
            // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - —Å–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            if (isModal) {
                navigateModalImage(productId, 1);
            } else {
                navigateProductImage(productId, 1);
            }
        } else {
            // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            if (isModal) {
                navigateModalImage(productId, -1);
            } else {
                navigateProductImage(productId, -1);
            }
        }
    }
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function openModal(productId) {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–≤–∞—Ä–∞
    window.currentProductId = productId;
    
    const product = products.find(p => p.id === productId);
    const modal = document.getElementById('productModal');
    const content = document.getElementById('modalContent');
    
    // –°–±—Ä–æ—Å –∏–Ω–¥–µ–∫—Å–∞ –∫–∞—Ä—É—Å–µ–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    window.modalImageIndex = 0;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
    let modalImages = product.images;
    if (product.hasColors && product.colors) {
        // –î–ª—è iPhone 15 Pro Max –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±–∏—Ä–∞–µ–º "–ß–µ—Ä–Ω—ã–π"
        let defaultColor = productId === 1 && product.colors["–ß–µ—Ä–Ω—ã–π"] ? "–ß–µ—Ä–Ω—ã–π" : Object.keys(product.colors)[0];
        
        const selectedColor = currentProductColor[productId] || defaultColor;
        modalImages = product.colors[selectedColor].images;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
        if (!currentProductColor[productId]) {
            currentProductColor[productId] = selectedColor;
        }
    }
    
    content.innerHTML = `
        <div class="modal-header">
            <div class="modal-image-container">
                ${modalImages && modalImages.length > 1 ? `
                    <div class="modal-images" id="modal-images-${productId}" onwheel="handleModalScroll(event, ${productId})" ontouchstart="handleTouchStart(event)" ontouchend="handleTouchEnd(event, ${productId}, true)">
                        ${modalImages.map((img, idx) => `
                            <img src="${img}" alt="${product.name}" class="modal-main-image">
                        `).join('')}
                    </div>
                    <button class="modal-arrow modal-arrow-left" onclick="navigateModalImage(${productId}, -1); event.stopPropagation();">‚ùÆ</button>
                    <button class="modal-arrow modal-arrow-right" onclick="navigateModalImage(${productId}, 1); event.stopPropagation();">‚ùØ</button>
                ` : `
                    <img id="mainImage" src="${modalImages[0]}" alt="${product.name}">
                `}
            </div>
            <div class="modal-details">
                <h2>${product.name}</h2>
                <div class="price">${product.price.toLocaleString()} ‚ÇΩ</div>
                <p class="modal-description">${product.description}</p>
                ${product.hasColors && product.colors ? `
                    <div class="modal-colors">
                        ${Object.keys(product.colors).map(color => {
                            const defaultColor = productId === 1 && product.colors["–ß–µ—Ä–Ω—ã–π"] ? "–ß–µ—Ä–Ω—ã–π" : Object.keys(product.colors)[0];
                            const isActive = (currentProductColor[productId] || defaultColor) === color;
                            return `
                            <button class="color-btn ${isActive ? 'active' : ''}" 
                                    onclick="selectColor(${productId}, '${color}');"
                                    title="${color}"></button>
                        `}).join('')}
                    </div>
                ` : ''}
                ${product.has3D ? `<button class="btn-3d" onclick="view3D('${product.model3D}', ${productId})">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä 3D –º–æ–¥–µ–ª–∏</button>` : ''}
                ${product.hasTradeIn ? `<button class="btn-trade-in" onclick="openTradeIn(${productId})">Trade-in</button>` : ''}
                <div class="modal-actions">
                    <button class="btn-add-to-cart" onclick="addToCart(${product.id}); closeModal();">
                        –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </div>
            </div>
        </div>
        <div class="modal-specs">
            <h3>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
            <ul>
                ${product.specs.map(spec => `<li>${spec}</li>`).join('')}
            </ul>
        </div>
    `;
    
    modal.style.display = 'block';
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–∞—Ä—É—Å–µ–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    if (modalImages && modalImages.length > 1) {
        setTimeout(() => updateModalCarouselPosition(productId), 10);
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
window.modalImageIndex = 0;

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∫–∞—Ä—É—Å–µ–ª–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
function updateModalCarouselPosition(productId, withBounce = false) {
    const container = document.getElementById(`modal-images-${productId}`);
    if (!container) return;
    
    const index = window.modalImageIndex || 0;
    const product = products.find(p => p.id === productId);
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
    let imagesArray = product.images;
    if (product.hasColors && product.colors) {
        // –î–ª—è iPhone 15 Pro Max –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±–∏—Ä–∞–µ–º "–ß–µ—Ä–Ω—ã–π"
        const defaultColor = productId === 1 && product.colors["–ß–µ—Ä–Ω—ã–π"] ? "–ß–µ—Ä–Ω—ã–π" : Object.keys(product.colors)[0];
        const selectedColor = currentProductColor[productId] || defaultColor;
        imagesArray = product.colors[selectedColor].images;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
        if (!currentProductColor[productId]) {
            currentProductColor[productId] = selectedColor;
        }
    }
    const maxIndex = imagesArray ? imagesArray.length - 1 : 0;
    
    let offset = -index * 100;
    
    // –≠—Ñ—Ñ–µ–∫—Ç "–±—É—Ñ–µ—Ä–∞" –Ω–∞ –∫—Ä–∞—è—Ö
    if (withBounce) {
        if (index < 0) {
            offset = -index * 10;
        } else if (index > maxIndex) {
            offset = -(maxIndex * 100 + (index - maxIndex) * 10);
        }
    }
    
    container.style.transform = `translateX(${offset}%)`;
    
    // –í–æ–∑–≤—Ä–∞—Ç –∫ –≥—Ä–∞–Ω–∏—Ü–µ –µ—Å–ª–∏ –±—ã–ª —ç—Ñ—Ñ–µ–∫—Ç –±—É—Ñ–µ—Ä–∞
    if (withBounce) {
        setTimeout(() => {
            if (window.modalImageIndex < 0) window.modalImageIndex = 0;
            if (window.modalImageIndex > maxIndex) window.modalImageIndex = maxIndex;
            updateModalCarouselPosition(productId);
        }, 300);
    }
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
function handleModalScroll(event, productId) {
    event.preventDefault();
    event.stopPropagation();
    
    const delta = event.deltaY > 0 ? 1 : -1;
    navigateModalImage(productId, delta);
}

// –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
function navigateModalImage(productId, direction) {
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
    let imagesArray = product.images;
    if (product.hasColors && product.colors) {
        const selectedColor = currentProductColor[productId] || Object.keys(product.colors)[0];
        imagesArray = product.colors[selectedColor].images;
    }
    
    if (!imagesArray) return;
    
    const maxIndex = imagesArray.length - 1;
    let newIndex = window.modalImageIndex + direction;
    
    window.modalImageIndex = newIndex;
    
    // –î–∞–µ–º —Å–¥–≤–∏–Ω—É—Ç—å –Ω–æ –ø–æ—Ç–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ—Å–ª–∏ –≤—ã—à–ª–∏ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã
    if (newIndex < 0 || newIndex > maxIndex) {
        updateModalCarouselPosition(productId, true);
    } else {
        updateModalCarouselPosition(productId);
    }
}

// –°–º–µ–Ω–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
function changeMainImage(src) {
    const mainImg = document.getElementById('mainImage');
    if (mainImg) {
        mainImg.src = src;
    }
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function closeModal() {
    document.getElementById('productModal').style.display = 'none';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –æ–∫–Ω–∞
window.onclick = function(event) {
    const modal = document.getElementById('productModal');
    if (event.target === modal) {
        closeModal();
    }
    const checkoutModal = document.getElementById('checkoutModal');
    if (event.target === checkoutModal) {
        closeCheckoutModal();
    }
    const viewer3D = document.getElementById('viewer3DModal');
    if (event.target === viewer3D) {
        close3DViewer();
    }
    const sbpModal = document.getElementById('sbpPaymentModal');
    if (event.target === sbpModal) {
        closeSbpPaymentModal();
    }
    const tradeInModal = document.getElementById('tradeInModal');
    if (event.target === tradeInModal) {
        closeTradeInModal();
    }
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
function addToCart(productId) {
    const product = products.find(p => p.id === productId);
    cart.push(product);
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    renderCart();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    showNotification(`${product.name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!`);
}

// –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
function removeFromCart(index) {
    const removedItem = cart[index];
    cart.splice(index, 1);
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    renderCart();
    showNotification(`${removedItem.name} —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã`);
}

// –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function showNotification(message, type = 'success') {
    const notification = document.createElement('div');
    notification.className = 'notification';
    notification.textContent = message;
    
    // –°—Ç—Ä–æ–≥–∏–π —Å—Ç–∏–ª—å - —Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ (–±–µ–∑ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤)
    let bgColor = '#1a1a1a';
    let textColor = '#ffffff';
    let borderColor = '#000000';
    let borderWidth = '2px';
    
    if (type === 'warning') {
        bgColor = '#ff9800';
        textColor = '#000000';
        borderColor = '#e68900';
    } else if (type === 'info') {
        bgColor = '#2196f3';
        textColor = '#ffffff';
        borderColor = '#0b7dda';
    } else if (type === 'error') {
        bgColor = '#f44336';
        textColor = '#ffffff';
        borderColor = '#d32f2f';
    }
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ - —ç–ª–µ–º–µ–Ω—Ç –∑–∞ –ª–µ–≤—ã–º –∫—Ä–∞–µ–º —ç–∫—Ä–∞–Ω–∞
    notification.style.cssText = `
        position: fixed;
        top: 100px;
        left: -500px;
        background: ${bgColor};
        color: ${textColor};
        padding: 16px 24px;
        border: ${borderWidth} solid ${borderColor};
        border-radius: 4px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 3000;
        opacity: 0;
        white-space: nowrap;
        font-weight: 500;
        font-size: 14px;
        letter-spacing: 0.3px;
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ DOM —Å–Ω–∞—á–∞–ª–∞
    document.body.appendChild(notification);
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ—Ñ–ª–æ—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    notification.offsetHeight;
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–ª–µ–≤–∞
    notification.style.animation = 'slideInFromLeft 0.3s ease-out forwards';
    
    setTimeout(() => {
        // –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –≤–ª–µ–≤–æ
        notification.style.animation = 'slideOutToLeft 0.3s ease-in forwards';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
function updateCartCount() {
    document.getElementById('cartCount').textContent = cart.length;
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
function toggleCart() {
    document.getElementById('cart').classList.toggle('open');
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã
    closeMobileMenu();
}

// –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
function toggleMobileMenu() {
    const mobileNav = document.getElementById('mobileNav');
    const toggle = document.getElementById('mobileMenuToggle');
    
    mobileNav.classList.toggle('active');
    toggle.classList.toggle('active');
    
    // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É body –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º –º–µ–Ω—é
    if (mobileNav.classList.contains('active')) {
        document.body.style.overflow = 'hidden';
    } else {
        document.body.style.overflow = '';
    }
}

function closeMobileMenu() {
    const mobileNav = document.getElementById('mobileNav');
    const toggle = document.getElementById('mobileMenuToggle');
    
    mobileNav.classList.remove('active');
    toggle.classList.remove('active');
    document.body.style.overflow = '';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
document.addEventListener('click', function(event) {
    const mobileNav = document.getElementById('mobileNav');
    const toggle = document.getElementById('mobileMenuToggle');
    
    if (mobileNav && mobileNav.classList.contains('active')) {
        if (!mobileNav.contains(event.target) && !toggle.contains(event.target)) {
            closeMobileMenu();
        }
    }
});

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ
let lastScrollTop = 0;
window.addEventListener('scroll', function() {
    const mobileNav = document.getElementById('mobileNav');
    if (mobileNav && mobileNav.classList.contains('active')) {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        if (Math.abs(scrollTop - lastScrollTop) > 5) {
            closeMobileMenu();
        }
        lastScrollTop = scrollTop;
    }
});

// –†–µ–Ω–¥–µ—Ä –∫–æ—Ä–∑–∏–Ω—ã
function renderCart() {
    const cartItems = document.getElementById('cartItems');
    const cartTotal = document.getElementById('cartTotal');
    
    if (cart.length === 0) {
        cartItems.innerHTML = '<p style="text-align: center; color: #999; padding: 2rem;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
        cartTotal.textContent = '0';
        return;
    }
    
    cartItems.innerHTML = cart.map((item, index) => `
        <div class="cart-item">
            <img src="${item.image}" alt="${item.name}">
            <div class="cart-item-info">
                <h4>${item.name}</h4>
                <p>${item.price.toLocaleString()} ‚ÇΩ</p>
            </div>
            <button class="cart-item-remove" onclick="removeFromCart(${index})" title="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
        </div>
    `).join('');
    
    const total = cart.reduce((sum, item) => sum + item.price, 0);
    cartTotal.textContent = total.toLocaleString();
}

// –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
function checkout() {
    if (cart.length === 0) {
        showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!');
        return;
    }
    document.getElementById('checkoutModal').style.display = 'block';
    document.getElementById('cart').classList.remove('open');
}

// –í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
function selectPaymentMethod(method) {
    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
    document.querySelectorAll('.payment-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ
    const selectedBtn = document.querySelector(`.payment-btn[data-method="${method}"]`);
    if (selectedBtn) {
        selectedBtn.classList.add('active');
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
    window.selectedPaymentMethod = method;
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∑–∞–∫–∞–∑–∞
function closeCheckoutModal() {
    document.getElementById('checkoutModal').style.display = 'none';
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–û –Ω–∞—Å"
function openAboutModal() {
    document.getElementById('aboutModal').style.display = 'block';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–û –Ω–∞—Å"
function closeAboutModal() {
    document.getElementById('aboutModal').style.display = 'none';
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ö–æ–Ω—Ç–∞–∫—Ç—ã"
function openContactModal() {
    document.getElementById('contactModal').style.display = 'block';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ö–æ–Ω—Ç–∞–∫—Ç—ã"
function closeContactModal() {
    document.getElementById('contactModal').style.display = 'none';
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –°–ë–ü –æ–ø–ª–∞—Ç—ã
function openSbpPaymentModal(amount) {
    const modal = document.getElementById('sbpPaymentModal');
    const amountElement = document.getElementById('sbpAmount');
    const qrCanvas = document.getElementById('sbpQrCode');
    
    if (!modal || !amountElement || !qrCanvas) {
        console.error('SBP Payment Modal elements not found');
        return;
    }
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—É–º–º—É
    amountElement.textContent = `${amount.toLocaleString()} ‚ÇΩ`;
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º QR-–∫–æ–¥
    // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É –¥–ª—è QR-–∫–æ–¥–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —ç—Ç–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å URL –æ—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞)
    const qrData = `ST00012|Name=Apple Favorite|PersonalAcc=12345678901234567890|BankName=Example Bank|BIC=044525225|CorrespAcc=30101810145250000001|Sum=${amount * 100}|Purpose=–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞`;
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º QR-–∫–æ–¥
    if (typeof QRCode !== 'undefined') {
        QRCode.toCanvas(qrCanvas, qrData, {
            width: 300,
            margin: 2,
            color: {
                dark: '#000000',
                light: '#FFFFFF'
            }
        }, function (error) {
            if (error) {
                console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR-–∫–æ–¥–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR-–∫–æ–¥–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.', 'error');
            }
        });
    } else {
        console.error('QRCode library not loaded');
        showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ QR-–∫–æ–¥–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.', 'error');
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    modal.style.display = 'block';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –°–ë–ü –æ–ø–ª–∞—Ç—ã
function closeSbpPaymentModal() {
    const modal = document.getElementById('sbpPaymentModal');
    if (modal) {
        modal.style.display = 'none';
    }
    
    // –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–µ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ
    if (window.pendingSbpOrder) {
        delete window.pendingSbpOrder;
    }
}

// –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –°–ë–ü
function confirmSbpPayment() {
    if (!window.pendingSbpOrder) {
        showNotification('–î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑ –∑–∞–Ω–æ–≤–æ.', 'error');
        closeSbpPaymentModal();
        return;
    }
    
    const { name, phone, email, address } = window.pendingSbpOrder;
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –°–ë–ü
    closeSbpPaymentModal();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ
    showNotification('‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–∏–Ω—è—Ç–∞! –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω.', 'success');
    
    // –ó–∞–≤–µ—Ä—à–∞–µ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    processOrderCompletion(name, phone, email, address);
    
    // –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–µ
    delete window.pendingSbpOrder;
}


// –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞
function submitOrder(event) {
    event.preventDefault();
    
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
    const name = document.getElementById('customerName').value;
    const phone = document.getElementById('customerPhone').value;
    const email = document.getElementById('customerEmail').value;
    const address = document.getElementById('customerAddress').value;
    
                // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
        const selectedBtn = document.querySelector('.payment-btn.active');
        const paymentMethod = selectedBtn?.dataset.method || 'card';
      
      // –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â—É—é —Å—É–º–º—É –∑–∞–∫–∞–∑–∞
      const totalPrice = cart.reduce((sum, item) => sum + item.price, 0);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω Google Pay
      if (window.googlePayUsed) {
          // –ü–ª–∞—Ç–µ–∂ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω —á–µ—Ä–µ–∑ Google Pay
          processOrderCompletion(name, phone, email, address);
          return;
      }
      
      // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
           switch(paymentMethod) {
           case 'card':
               // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–ø–ª–∞—Ç—ã
              const orderData = {
                  name: name,
                  phone: phone,
                  email: email,
                  address: address,
                  items: cart.map(item => ({
                      id: item.id,
                      name: item.name,
                      price: item.price
                  })),
                  total: totalPrice,
                  paymentMethod: 'card'
              };
              localStorage.setItem('pendingOrder', JSON.stringify(orderData));
              
              // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã –∫–∞—Ä—Ç–æ–π
              try {
                  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–±–æ–ª—å—à–æ–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage
                  setTimeout(() => {
                      window.location.href = 'payment.html';
                  }, 100);
              } catch (error) {
                  console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã:', error);
                  alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
              }
              break;
                          
          case 'sbp':
              // –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –°–ë–ü - –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å QR-–∫–æ–¥–æ–º
              // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã
              window.pendingSbpOrder = {
                  name: name,
                  phone: phone,
                  email: email,
                  address: address,
                  total: totalPrice
              };
              
              // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
              closeCheckoutModal();
              
              // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –°–ë–ü
              openSbpPaymentModal(totalPrice);
              break;
            
        case 'googlepay':
            // –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Google Pay
            if (!googlePayClient) {
                initGooglePay();
            }
            
            // –ï—Å–ª–∏ Google Pay –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ–º –ø–ª–∞—Ç–µ–∂
            if (googlePayClient) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å Google Pay
                googlePayClient.isReadyToPay({
                    apiVersion: 2,
                    apiVersionMinor: 0,
                    allowedPaymentMethods: [
                        {
                            type: 'CARD',
                            parameters: {
                                allowedAuthMethods: ['PAN_ONLY', 'CRYPTOGRAM_3DS'],
                                allowedCardNetworks: ['MASTERCARD', 'VISA']
                            },
                            tokenizationSpecification: {
                                type: 'PAYMENT_GATEWAY',
                                parameters: {
                                    gateway: 'example',
                                    gatewayMerchantId: 'exampleGatewayMerchantId'
                                }
                            }
                        }
                    ]
                }).then((response) => {
                    if (response.result) {
                        // Google Pay –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ–º –ø–ª–∞—Ç–µ–∂
                        const paymentDataRequest = getGooglePayPaymentDataRequest();
                        
                        googlePayClient.loadPaymentData(paymentDataRequest)
                            .then((paymentData) => {
                                // –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                                processGooglePayPayment(paymentData);
                            })
                            .catch((err) => {
                                console.error('–û—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Google Pay:', err);
                                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –ø–ª–∞—Ç–µ–∂, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—ã—á–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
                                if (err.statusCode === 'CANCELED') {
                                    showNotification('–û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Google Pay –æ—Ç–º–µ–Ω–µ–Ω–∞. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã.', 'warning');
                                } else {
                                    showNotification('–û—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Google Pay. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã.', 'error');
                                }
                            });
                    } else {
                        // Google Pay –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
                        showNotification('Google Pay –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã.', 'warning');
                    }
                }).catch((err) => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ Google Pay:', err);
                    showNotification('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ Google Pay. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã.', 'warning');
                });
            } else {
                // Google Pay –∫–ª–∏–µ–Ω—Ç –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
                showNotification('Google Pay –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã.', 'warning');
            }
            break;
            
                                     default:
               // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - –æ–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
               const defaultOrderData = {
                   name: name,
                   phone: phone,
                   email: email,
                   address: address,
                   items: cart.map(item => ({
                       id: item.id,
                       name: item.name,
                       price: item.price
                   })),
                   total: totalPrice,
                   paymentMethod: 'card'
               };
              localStorage.setItem('pendingOrder', JSON.stringify(defaultOrderData));
              
              // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã –∫–∞—Ä—Ç–æ–π
              try {
                  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ–±–æ–ª—å—à–æ–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage
                  setTimeout(() => {
                      window.location.href = 'payment.html';
                  }, 100);
              } catch (error) {
                  console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã:', error);
                  alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
              }
      }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è blob URLs
function clearBlobUrls() {
    activeBlobUrls.forEach(url => {
        try {
            URL.revokeObjectURL(url);
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏ blob URL:', e);
        }
    });
    activeBlobUrls.clear();
}

// 3D –ø—Ä–æ—Å–º–æ—Ç—Ä —Å model-viewer
function view3D(modelPath, productId) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –æ—Ç–∫—Ä—ã—Ç –ª–∏ —É–∂–µ 3D viewer
    const currentModal = document.getElementById('viewer3DModal');
    if (currentModal && currentModal.style.display === 'block') {
        // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–∫—Ä—ã–≤–∞–µ–º –∏ –∂–¥–µ–º
        close3DViewer();
        setTimeout(() => {
            open3DViewer(modelPath, productId);
        }, 350);
        return;
    }
    
    open3DViewer(modelPath, productId);
}

// –û—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è 3D viewer
function open3DViewer(modelPath, productId) {
    closeModal();
    
    // –í–ê–ñ–ù–û: –°–æ—Ö—Ä–∞–Ω—è–µ–º productId –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
    if (productId) {
        window.currentProductId = productId;
    }
    
    // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ blob URLs
    clearBlobUrls();
    
    const modal = document.getElementById('viewer3DModal');
    const container = document.getElementById('viewer3D');
    
    if (!container || !modal) {
        console.error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
        return;
    }
    
    // –í–ê–ñ–ù–û: –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä - –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑
    // –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á–∏—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
    container.innerHTML = '';
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —á–∏—Å—Ç—ã–π —ç–ª–µ–º–µ–Ω—Ç model-viewer
    const modelViewer = document.createElement('model-viewer');
    modelViewer.id = 'model-viewer';
    modelViewer.setAttribute('camera-controls', '');
    modelViewer.setAttribute('auto-rotate', '');
    modelViewer.setAttribute('auto-rotate-delay', '0');
    modelViewer.setAttribute('rotation-per-second', '30deg');
    modelViewer.setAttribute('shadow-intensity', '1');
    modelViewer.setAttribute('environment-image', 'neutral');
    modelViewer.setAttribute('interaction-policy', 'allow-when-focused');
    modelViewer.setAttribute('loading', 'auto'); // –í–∞–∂–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
    modelViewer.setAttribute('reveal', 'auto'); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ
    modelViewer.style.width = '100%';
    modelViewer.style.height = '100%';
    modelViewer.style.display = 'block';
    modelViewer.style.background = 'transparent'; // –ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏
    
    // AR –∫–Ω–æ–ø–∫–∞
    const arButton = document.createElement('button');
    arButton.setAttribute('slot', 'ar-button');
    arButton.className = 'btn-control';
    arButton.style.cssText = 'position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); z-index: 10;';
    arButton.textContent = 'AR –ü—Ä–æ—Å–º–æ—Ç—Ä';
    modelViewer.appendChild(arButton);
    
    container.appendChild(modelViewer);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    modal.style.display = 'block';
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏
    function loadStandardModel(pathToUse) {
        const currentViewer = document.getElementById('model-viewer');
        if (!currentViewer) {
            console.error('‚ùå model-viewer —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
            return;
        }
        
        const path = pathToUse || modelPath;
        
        if (path && !path.startsWith('blob:') && !path.startsWith('data:')) {
            // –ö–æ–¥–∏—Ä—É–µ–º –ø—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è GitHub Pages (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ–±–µ–ª—ã)
            const standardSrc = encodeURI(path).replace(/%20/g, '%20');
            
            console.log('üìÅ –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –º–æ–¥–µ–ª—å:', {
                –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π–ü—É—Ç—å: path,
                –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π–ü—É—Ç—å: standardSrc,
                —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: isMobile ? 'mobile' : 'desktop'
            });
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º src
            currentViewer.src = standardSrc;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            currentViewer.addEventListener('load', () => {
                console.log('‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞:', standardSrc);
            });
            
            currentViewer.addEventListener('error', (event) => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏:', {
                    –ø—É—Ç—å: standardSrc,
                    –æ—à–∏–±–∫–∞: event.detail || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞',
                    —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: isMobile ? 'mobile' : 'desktop'
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                showNotification('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ 3D –º–æ–¥–µ–ª–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞.', 'error');
            });
            
            // –ù–∞ PC –¥–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ —Ç–∞–π–º–∞—É—Ç
            if (!isMobile) {
                setTimeout(() => {
                    if (!currentViewer.loaded && !currentViewer.loading) {
                        console.error('‚ùå –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ PC, –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—É—Ç—å:', standardSrc);
                        
                        // –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å –±–µ–∑ encodeURI –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞–µ–≤
                        const altPath = path.replace(/\s/g, '%20');
                        if (altPath !== standardSrc) {
                            console.log('üîÑ –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å:', altPath);
                            currentViewer.src = altPath;
                        }
                    }
                }, 2000);
            }
        } else if (path) {
            const fallbackSrc = path.startsWith('blob:') || path.startsWith('data:') ? path : encodeURI(path);
            currentViewer.src = fallbackSrc;
            console.log('‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å (fallback):', fallbackSrc);
        } else {
            console.warn('‚ö†Ô∏è –ü—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω');
        }
    }
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                     (window.innerWidth <= 768 && window.innerHeight <= 1024);
    
    // –ù–∞ PC –Ω—É–∂–Ω–∞ –±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ model-viewer
    // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —Ç–æ–∂–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
    const initDelay = isMobile ? 600 : 800;
    
    console.log('üì± –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:', isMobile ? '–º–æ–±–∏–ª—å–Ω–æ–µ' : '–¥–µ—Å–∫—Ç–æ–ø', '–∑–∞–¥–µ—Ä–∂–∫–∞:', initDelay, 'ms', 'productId:', productId, 'modelPath:', modelPath);
    
    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
    // Web Components —Ç—Ä–µ–±—É—é—Ç –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    setTimeout(() => {
        const readyViewer = document.getElementById('model-viewer');
        if (!readyViewer) {
            console.error('‚ùå model-viewer –Ω–µ —Å–æ–∑–¥–∞–Ω –ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏');
            return;
        }
        
        console.log('‚úÖ model-viewer –Ω–∞–π–¥–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥–µ–ª–∏');
        
        // –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –º–æ–¥–µ–ª—å –∏–∑ –ø–∞–ø–∫–∏ models/ (–µ—Å–ª–∏ –µ—Å—Ç—å modelPath)
        // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤–µ–∑–¥–µ (PC –∏ –º–æ–±–∏–ª—å–Ω—ã–µ)
        if (modelPath && !modelPath.startsWith('blob:') && !modelPath.startsWith('data:')) {
            console.log('üìÅ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏–∑ –ø–∞–ø–∫–∏ models/:', modelPath);
            
            // –ù–∞ PC –¥–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ viewer
            const loadDelay = isMobile ? 0 : 200;
            
            setTimeout(() => {
                loadStandardModel();
            }, loadDelay);
            
            return; // –ó–∞–≤–µ—Ä—à–∞–µ–º - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞
        }
        
        // –ü–†–ò–û–†–ò–¢–ï–¢ 2: –ï—Å–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–µ—Ç, –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∏–∑ IndexedDB
        // –õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç–µ–∫—É—â–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        if (productId) {
            // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ db –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞, –µ—Å–ª–∏ –Ω–µ—Ç - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
            const dbCheck = db ? Promise.resolve(db) : initDB();
            
            dbCheck.then(() => {
                if (!db) {
                    console.warn('‚ö†Ô∏è IndexedDB –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.');
                    showNotification('‚ö†Ô∏è 3D –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.', 'warning');
                    return;
                }
                
                console.log('üîç –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–µ—Ç, –ø—Ä–æ–≤–µ—Ä—è–µ–º IndexedDB –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ID:', productId);
                
                // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –¥–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è IndexedDB
                const dbDelay = isMobile ? 100 : 0;
                
                setTimeout(() => {
                    try {
                        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ IndexedDB
                        const transaction = db.transaction(['models'], 'readonly');
                        const store = transaction.objectStore('models');
                        const request = store.get(productId);
                        
                        request.onsuccess = () => {
                            const currentViewer = document.getElementById('model-viewer');
                            if (!currentViewer) {
                                console.error('‚ùå model-viewer —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏');
                                return;
                            }
                            
                            console.log('üì¶ –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ IndexedDB:', request.result ? '–Ω–∞–π–¥–µ–Ω–æ' : '–Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                            
                            if (request.result && request.result.model) {
                                // –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞–π–¥–µ–Ω–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ—ë –∫–∞–∫ fallback
                                const arrayBuffer = request.result.model;
                                console.log('‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞–π–¥–µ–Ω–∞ (fallback), —Ä–∞–∑–º–µ—Ä:', arrayBuffer.byteLength, '–±–∞–π—Ç');
                                
                                // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
                                const blobDelay = isMobile ? 50 : 0;
                                
                                setTimeout(() => {
                                    try {
                                        const blob = new Blob([arrayBuffer], { type: 'application/octet-stream' });
                                        const blobUrl = URL.createObjectURL(blob);
                                        activeBlobUrls.add(blobUrl);
                                        
                                        const finalViewer = document.getElementById('model-viewer');
                                        if (finalViewer) {
                                            finalViewer.src = blobUrl;
                                            console.log('‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ IndexedDB –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ID:', productId, '—Ä–∞–∑–º–µ—Ä:', arrayBuffer.byteLength, '–±–∞–π—Ç');
                                            showNotification('‚ÑπÔ∏è –ü–æ–∫–∞–∑–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å (–¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ)', 'info');
                                        } else {
                                            console.error('‚ùå model-viewer –Ω–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ blob');
                                        }
                                    } catch (blobError) {
                                        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è Blob:', blobError);
                                    }
                                }, blobDelay);
                            } else {
                                // –õ–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ —Ç–æ–∂–µ –Ω–µ—Ç
                                console.log('‚ö†Ô∏è –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                                showNotification('‚ö†Ô∏è 3D –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.', 'warning');
                            }
                        };
                        
                        request.onerror = () => {
                            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ IndexedDB:', request.error);
                            showNotification('‚ö†Ô∏è 3D –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.', 'warning');
                        };
                    } catch (dbError) {
                        console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å IndexedDB:', dbError);
                        showNotification('‚ö†Ô∏è 3D –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.', 'warning');
                    }
                }, dbDelay);
            }).catch(err => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ IndexedDB:', err);
                showNotification('‚ö†Ô∏è 3D –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.', 'warning');
            });
            
            return; // –í—ã—Ö–æ–¥–∏–º, —Ç–∞–∫ –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è
        }
        
        // –ï—Å–ª–∏ –Ω–µ—Ç –Ω–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏, –Ω–∏ productId
        console.log('‚ö†Ô∏è –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞ –∏ productId –Ω–µ –Ω–∞–π–¥–µ–Ω');
        showNotification('‚ö†Ô∏è 3D –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ –ø–∞–ø–∫—É models/ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.', 'warning');
    }, initDelay); // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ (—É—Å—Ç–∞—Ä–µ–≤—à–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
function checkLocalModel(productId) {
    if (!db) return;
    
    const transaction = db.transaction(['models'], 'readonly');
    const store = transaction.objectStore('models');
    const request = store.get(productId);
    
    request.onsuccess = () => {
        if (request.result) {
            // –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞–π–¥–µ–Ω–∞ - –æ–Ω–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ 3D viewer
            console.log('‚ÑπÔ∏è –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞–π–¥–µ–Ω–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ID:', productId);
        }
    };
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏–∑ IndexedDB (—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ GitHub Pages –Ω–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö)
function loadModelFromDB(productId, modelViewer) {
    if (!db) {
        console.log('IndexedDB –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –º–æ–¥–µ–ª—å');
        return;
    }
    
    const transaction = db.transaction(['models'], 'readonly');
    const store = transaction.objectStore('models');
    const request = store.get(productId);
    
    request.onsuccess = () => {
        if (request.result) {
            const arrayBuffer = request.result.model;
            const blob = new Blob([arrayBuffer]);
            const blobUrl = URL.createObjectURL(blob);
            activeBlobUrls.add(blobUrl);
            modelViewer.src = blobUrl;
            console.log('‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ IndexedDB –¥–ª—è —Ç–æ–≤–∞—Ä–∞:', productId);
            showNotification('‚ÑπÔ∏è –ü–æ–∫–∞–∑–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å (–¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ)', 'info');
        } else {
            console.log('–ù–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é');
        }
    };
    
    request.onerror = () => {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ IndexedDB:', request.error);
    };
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ 3D –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
function close3DViewer() {
    const modal = document.getElementById('viewer3DModal');
    const container = document.getElementById('viewer3D');
    const modelViewer = document.getElementById('model-viewer');
    
    if (!modal) return;
    
    // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º blob URLs
    clearBlobUrls();
    
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ model-viewer –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
    if (modelViewer) {
        try {
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–ø–æ–≤–æ—Ä–æ—Ç –∏ –∞–Ω–∏–º–∞—Ü–∏–∏
            if (modelViewer.pause) {
                modelViewer.pause();
            }
            
            // –û—á–∏—â–∞–µ–º src –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
            modelViewer.src = '';
        } catch (e) {
            // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ
        }
    }
    
    // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    modal.style.display = 'none';
    
    // –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç —á–µ—Ä–µ–∑ –∑–∞–¥–µ—Ä–∂–∫—É
    // –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
    setTimeout(() => {
        if (container) {
            container.innerHTML = '';
        }
    }, 150);
}

// –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from {
            transform: translateX(400px);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    @keyframes slideOut {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(400px);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);

// Google Pay Integration
let googlePayClient;
window.googlePayUsed = false;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Google Pay
function initGooglePay() {
    if (typeof google === 'undefined' || !google.payments || !google.payments.api) {
        console.log('Google Pay API –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –û–∂–∏–¥–∞–µ–º –∑–∞–≥—Ä—É–∑–∫–∏...');
        // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 500–º—Å
        setTimeout(() => {
            if (typeof google !== 'undefined' && google.payments && google.payments.api) {
                googlePayClient = new google.payments.api.PaymentsClient({
                    environment: 'TEST' // –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ 'PRODUCTION'
                });
            }
        }, 500);
        return;
    }
    
    googlePayClient = new google.payments.api.PaymentsClient({
        environment: 'TEST' // –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ 'PRODUCTION'
    });
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
function getGooglePayPaymentDataRequest() {
    // –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â—É—é —Å—É–º–º—É –∫–æ—Ä–∑–∏–Ω—ã
    const totalPrice = cart.reduce((sum, item) => sum + item.price, 0);
    
    return {
        apiVersion: 2,
        apiVersionMinor: 0,
        merchantInfo: {
            merchantId: 'BCR2DN6TZ3Y4RZP2', // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à Merchant ID
            merchantName: 'Apple Favorite'
        },
        allowedPaymentMethods: [
            {
                type: 'CARD',
                parameters: {
                    allowedAuthMethods: ['PAN_ONLY', 'CRYPTOGRAM_3DS'],
                    allowedCardNetworks: ['MASTERCARD', 'VISA']
                },
                tokenizationSpecification: {
                    type: 'PAYMENT_GATEWAY',
                    parameters: {
                        gateway: 'example',
                        gatewayMerchantId: 'exampleGatewayMerchantId'
                    }
                }
            }
        ],
        transactionInfo: {
            totalPriceStatus: 'FINAL',
            totalPriceLabel: '–ò—Ç–æ–≥–æ',
            totalPrice: totalPrice.toString(),
            currencyCode: 'RUB',
            countryCode: 'RU'
        },
        callbackIntents: ['PAYMENT_AUTHORIZATION']
    };
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ Google Pay
function processGooglePayPayment(paymentData) {
    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É
    // –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ –ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑
    
    // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ—á–∞–µ–º, —á—Ç–æ Google Pay –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω
    window.googlePayUsed = true;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –ª–∏ –ø–æ–ª—è —Ñ–æ—Ä–º—ã
    const name = document.getElementById('customerName').value;
    const phone = document.getElementById('customerPhone').value;
    const email = document.getElementById('customerEmail').value;
    const address = document.getElementById('customerAddress').value;
    
    if (!name || !phone || !email || !address) {
        showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ–π', 'warning');
        window.googlePayUsed = false;
        return;
    }
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –ø–ª–∞—Ç–µ–∂–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
    // –ó–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –æ–ø–ª–∞—Ç—É
    showNotification('‚úÖ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Google Pay —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!', 'success');
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –∑–∞–∫–∞–∑
    setTimeout(() => {
        processOrderCompletion(name, phone, email, address);
    }, 1500);
}

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
function processOrderCompletion(name, phone, email, address) {
    showNotification('–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
    
    cart = [];
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
    updateCartCount();
    closeCheckoutModal();
    
    // –°–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ Google Pay
    window.googlePayUsed = false;
    
    // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
    document.getElementById('checkoutForm').reset();
}

// ==================== –°–õ–ê–ô–î–ï–†–´ ====================

// –ì–ª–∞–≤–Ω—ã–π —Å–ª–∞–π–¥–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞, —É—Å–ª—É–≥–∏, —Ä–∞–±–æ—Ç—ã)
let currentMainSlideIndex = 0;
const totalMainSlides = 3;

function slideMainContent(direction) {
    const track = document.getElementById('mainContentTrack');
    if (!track) return;
    
    currentMainSlideIndex += direction;
    
    if (currentMainSlideIndex < 0) {
        currentMainSlideIndex = totalMainSlides - 1;
    } else if (currentMainSlideIndex >= totalMainSlides) {
        currentMainSlideIndex = 0;
    }
    
    track.style.transform = `translateX(-${currentMainSlideIndex * 100}%)`;
    updateMainSliderDots();
}

function goToMainSlide(index) {
    currentMainSlideIndex = index;
    const track = document.getElementById('mainContentTrack');
    if (track) {
        track.style.transform = `translateX(-${currentMainSlideIndex * 100}%)`;
        updateMainSliderDots();
    }
}

function updateMainSliderDots() {
    const dotsContainer = document.getElementById('mainSliderDots');
    if (!dotsContainer) return;
    
    dotsContainer.innerHTML = '';
    for (let i = 0; i < totalMainSlides; i++) {
        const dot = document.createElement('button');
        dot.className = `main-slider-dot ${i === currentMainSlideIndex ? 'active' : ''}`;
        dot.onclick = () => goToMainSlide(i);
        dotsContainer.appendChild(dot);
    }
}

// –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞
let mainSliderAutoSlideInterval;

function startMainSliderAutoSlide() {
    mainSliderAutoSlideInterval = setInterval(() => {
        slideMainContent(1);
    }, 8000); // –ú–µ–Ω—è–µ–º –∫–∞–∂–¥—ã–µ 8 —Å–µ–∫—É–Ω–¥
}

function stopMainSliderAutoSlide() {
    if (mainSliderAutoSlideInterval) {
        clearInterval(mainSliderAutoSlideInterval);
    }
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —É—Å–ª—É–≥–∞–º–∏ —Ä–µ–º–æ–Ω—Ç–∞
const repairServices = {
    'battery': {
        title: '–ó–∞–º–µ–Ω–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞',
        price: '–æ—Ç 1500 ‚ÇΩ'
    },
    'glass': {
        title: '–ó–∞–º–µ–Ω–∞ –∑–∞–¥–Ω–µ–≥–æ —Å—Ç–µ–∫–ª–∞ –∏ –∫–æ—Ä–ø—É—Å–∞',
        price: '–æ—Ç 2500 ‚ÇΩ'
    },
    'polish': {
        title: '–ü–æ–ª–∏—Ä–æ–≤–∫–∞ —Å—Ç–µ–∫–ª–∞',
        price: 'iPhone, Apple Watch –æ—Ç 2000 ‚ÇΩ'
    },
    'screen': {
        title: '–ü–µ—Ä–µ–∫–ª–µ–π–∫–∞ —Å—Ç–µ–∫–ª–∞',
        price: '–æ—Ç 2500 ‚ÇΩ'
    },
    'protection': {
        title: '–ó–∞—â–∏—Ç–Ω—ã–µ —Å—Ç—ë–∫–ª–∞ –∏ —á–µ—Ö–ª—ã',
        price: '–æ—Ç 300 ‚ÇΩ'
    },
    'other': {
        title: '–î—Ä—É–≥–∏–µ –≤–∏–¥—ã —É—Å–ª—É–≥',
        price: '–æ—Ç 500 ‚ÇΩ'
    }
};

function openRepairService(serviceId) {
    const service = repairServices[serviceId];
    if (!service) return;
    
    // –°–∫—Ä—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—ã–π —Å–ª–∞–π–¥–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
    document.querySelector('.main-content-slider-section').style.display = 'none';
    document.querySelector('#products').style.display = 'none';
    document.querySelector('#repairServiceOrder').style.display = 'block';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
    document.getElementById('repairServiceTitle').textContent = service.title;
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Ä–∞–±–æ—Ç
    loadRepairWorksGallery();
    
    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Å–µ–∫—Ü–∏–∏
    document.getElementById('repairServiceOrder').scrollIntoView({ behavior: 'smooth' });
}

function closeRepairService() {
    document.querySelector('.main-content-slider-section').style.display = 'block';
    document.querySelector('#products').style.display = 'block';
    document.querySelector('#repairServiceOrder').style.display = 'none';
    
    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–∞—á–∞–ª—É
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function loadRepairWorksGallery() {
    const gallery = document.getElementById('repairWorksGallery');
    if (!gallery) return;
    
    gallery.innerHTML = '';
    workImages.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        img.alt = '–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã';
        img.onclick = () => {
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            window.open(src, '_blank');
        };
        gallery.appendChild(img);
    });
}

function submitRepairService(event) {
    event.preventDefault();
    
    const formData = {
        service: document.getElementById('repairServiceTitle').textContent,
        name: document.getElementById('repairName').value,
        phone: document.getElementById('repairPhone').value,
        device: document.getElementById('repairDevice').value,
        description: document.getElementById('repairDescription').value,
        dateTime: document.getElementById('repairDateTime').value
    };
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage (–º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä)
    const repairs = JSON.parse(localStorage.getItem('repairOrders') || '[]');
    repairs.push({
        ...formData,
        date: new Date().toISOString()
    });
    localStorage.setItem('repairOrders', JSON.stringify(repairs));
    
    showNotification('‚úÖ –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.', 'success');
    
    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
    document.getElementById('repairServiceForm').reset();
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é
    setTimeout(() => {
        closeRepairService();
    }, 2000);
}

// –ö–∞—Ä—É—Å–µ–ª–∏ —Ä–∞–±–æ—Ç
const workImages = [
    'images/raboti/2trp21a25uyo0c44o0440g8kw048g4.png',
    'images/raboti/4v32kjykgyec4ok0oogc0g84s4gwks.png',
    'images/raboti/6m54sw4x78wswoog0wg4k4cgg08ggw.png',
    'images/raboti/6nth0bill4sgs4gg0wwos404ccwo00.png',
    'images/raboti/7e4e5907a4863633669a2714f7d67a234e25a3d7.png',
    'images/raboti/885x04qfnbswososc4s4sw88wws048.png',
    'images/raboti/9k6hggv0qcws04s00ckkk4ow8kg48g.png',
    'images/raboti/b6a3xyntz20ww0ow4kgoc88kkkwwc0.png',
    'images/raboti/ed34d69c8a1a40d3e84b89b8ff850868bd445144.png',
    'images/raboti/i2angvhnpmo0ow4wowwggkk0skgg8w.png',
    'images/raboti/k57pvp0plk0k4gws0wwg0kk84gco00.png',
    'images/raboti/q91uwlszpz4w0s0g0w4wocggoc40g0.png',
    'images/raboti/r7t34xni5lw4kwgsoog40g44kw4kck.png'
];

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—É—Å–µ–ª–µ–π —Ä–∞–±–æ—Ç
function initWorksCarousels() {
    const carousel1 = document.getElementById('worksCarousel1');
    const carousel2 = document.getElementById('worksCarousel2');
    
    if (!carousel1 || !carousel2) return;
    
    // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–ª—É—á–∞–π–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
    const shuffledImages = [...workImages].sort(() => Math.random() - 0.5);
    
    // –†–∞–∑–¥–µ–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã
    const half = Math.ceil(shuffledImages.length / 2);
    const images1 = shuffledImages.slice(0, half);
    const images2 = shuffledImages.slice(half);
    
    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    function preloadImages(imageArray) {
        imageArray.forEach(src => {
            const img = new Image();
            img.src = src;
        });
    }
    
    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    preloadImages(workImages);
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–¥–ª—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏)
    function createCarouselImages(images, container) {
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 5 —Ä–∞–∑ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        // –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–µ—Ä–µ—Ö–æ–¥ –±—ã–ª –Ω–µ–∑–∞–º–µ—Ç–Ω—ã–º –∏ –≤—Å–µ–≥–¥–∞ –±—ã–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const copies = 5;
        for (let i = 0; i < copies; i++) {
            images.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                img.alt = '–ù–∞—à–∞ —Ä–∞–±–æ—Ç–∞';
                img.className = 'work-image';
                // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–¥–µ—Ä–∂–µ–∫
                img.loading = 'eager';
                img.decoding = 'async';
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
                img.onerror = function() {
                    this.style.display = 'none';
                };
                container.appendChild(img);
            });
        }
    }
    
    createCarouselImages(images1, carousel1);
    createCarouselImages(images2, carousel2);
    
    // –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–ª–∞–≤–Ω—É—é –±–µ—Å–∫–æ–Ω–µ—á–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É
    // –ü–µ—Ä–≤–∞—è –∫–∞—Ä—É—Å–µ–ª—å –¥–≤–∏–∂–µ—Ç—Å—è –≤–ª–µ–≤–æ, –≤—Ç–æ—Ä–∞—è - –≤–ø—Ä–∞–≤–æ
    setupInfiniteScroll(carousel1, images1.length, -1); // -1 = –≤–ª–µ–≤–æ
    setupInfiniteScroll(carousel2, images2.length, 1);  // 1 = –≤–ø—Ä–∞–≤–æ
    
    // –ó–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ–º drag —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–Ω–∏–º–∞—Ü–∏–∏)
    setTimeout(() => {
        setupCarouselDrag(carousel1);
        setupCarouselDrag(carousel2);
    }, 100);
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–≤–Ω–æ–π –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
// direction: -1 = –≤–ª–µ–≤–æ, 1 = –≤–ø—Ä–∞–≤–æ
function setupInfiniteScroll(carousel, imageCount, direction = -1) {
    const container = carousel.parentElement;
    let animationFrame = null;
    let isPaused = false;
    let isDragging = false;
    const speed = 0.3; // –ø–∏–∫—Å–µ–ª–µ–π –∑–∞ –∫–∞–¥—Ä (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å)
    const imageWidth = 300 + 24; // —à–∏—Ä–∏–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è + gap (1.5rem = 24px)
    const setWidth = imageWidth * imageCount; // —à–∏—Ä–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    const moveSpeed = speed * direction; // —Å–∫–æ—Ä–æ—Å—Ç—å —Å —É—á–µ—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    
    // –î–ª—è –¥–≤–∏–∂–µ–Ω–∏—è –≤–ø—Ä–∞–≤–æ –Ω–∞—á–∏–Ω–∞–µ–º —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏, —á—Ç–æ–±—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª–∏ –≤–∏–¥–Ω—ã
    let currentPosition = direction === 1 ? -setWidth : 0;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ drag
    window.carouselAnimations = window.carouselAnimations || {};
    const carouselId = carousel.id;
    
    function animate() {
        if (isPaused || isDragging) {
            animationFrame = requestAnimationFrame(animate);
            return;
        }
        
        // –î–≤–∏–≥–∞–µ–º –∫–∞—Ä—É—Å–µ–ª—å –≤ –Ω—É–∂–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
        currentPosition += moveSpeed;
        
        // –ö–æ–≥–¥–∞ –ø—Ä–æ—à–ª–∏ –æ–¥–∏–Ω –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä, –Ω–µ–∑–∞–º–µ—Ç–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é
        // –¢–∞–∫ –∫–∞–∫ —É –Ω–∞—Å 5 –∫–æ–ø–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø–µ—Ä–µ—Ö–æ–¥ –±—É–¥–µ—Ç –Ω–µ–∑–∞–º–µ—Ç–µ–Ω
        if (direction === -1) {
            // –î–≤–∏–∂–µ–Ω–∏–µ –≤–ª–µ–≤–æ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
            if (currentPosition <= -setWidth) {
                currentPosition = currentPosition + setWidth; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞ –Ω–∞—á–∞–ª–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞
            }
        } else {
            // –î–≤–∏–∂–µ–Ω–∏–µ –≤–ø—Ä–∞–≤–æ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
            // –î–ª—è –¥–≤–∏–∂–µ–Ω–∏—è –≤–ø—Ä–∞–≤–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –∫–æ–≥–¥–∞ –ø–æ–∑–∏—Ü–∏—è —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π
            if (currentPosition >= 0) {
                currentPosition = currentPosition - setWidth; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞ –Ω–∞—á–∞–ª–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞
            }
        }
        
        carousel.style.transform = `translateX(${currentPosition}px)`;
        
        animationFrame = requestAnimationFrame(animate);
    }
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    window.carouselAnimations[carouselId] = {
        pause: () => { isPaused = true; },
        resume: () => { 
            isPaused = false; 
            if (!animationFrame) {
                animationFrame = requestAnimationFrame(animate);
            }
        },
        setDragging: (value) => { isDragging = value; },
        setPosition: (pos) => { currentPosition = pos; },
        getPosition: () => currentPosition
    };
    
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    container.addEventListener('mouseenter', () => {
        isPaused = true;
    });
    
    // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ —É—Ö–æ–¥–µ –º—ã—à–∏
    container.addEventListener('mouseleave', () => {
        if (!isDragging) {
            isPaused = false;
            if (!animationFrame) {
                animationFrame = requestAnimationFrame(animate);
            }
        }
    });
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
    animationFrame = requestAnimationFrame(animate);
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ drag/swipe –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–µ–π
function setupCarouselDrag(carousel) {
    let isDown = false;
    let startX;
    let startTranslate = 0;
    let currentTranslate = 0;
    
    const container = carousel.parentElement;
    const carouselId = carousel.id;
    const carouselControl = window.carouselAnimations?.[carouselId];
    
    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–º–µ—â–µ–Ω–∏–µ –∏–∑ –∞–Ω–∏–º–∞—Ü–∏–∏
    function getAnimationOffset() {
        if (carouselControl) {
            return carouselControl.getPosition();
        }
        const computedStyle = window.getComputedStyle(carousel);
        const matrix = computedStyle.transform;
        if (matrix === 'none') return 0;
        const values = matrix.split('(')[1].split(')')[0].split(',');
        return parseFloat(values[4]) || 0;
    }
    
    // Mouse events
    container.addEventListener('mousedown', (e) => {
        isDown = true;
        startX = e.pageX;
        startTranslate = getAnimationOffset();
        currentTranslate = startTranslate;
        
        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∞–Ω–∏–º–∞—Ü–∏—é
        if (carouselControl) {
            carouselControl.setDragging(true);
            carouselControl.pause();
        }
        
        carousel.style.transition = 'none';
        container.style.cursor = 'grabbing';
        e.preventDefault();
    });
    
    container.addEventListener('mouseleave', () => {
        if (isDown) {
            isDown = false;
            if (carouselControl) {
                carouselControl.setPosition(currentTranslate);
                carouselControl.setDragging(false);
                carouselControl.resume();
            }
            carousel.style.transition = '';
            container.style.cursor = 'grab';
        }
    });
    
    container.addEventListener('mouseup', () => {
        if (isDown) {
            isDown = false;
            if (carouselControl) {
                carouselControl.setPosition(currentTranslate);
                carouselControl.setDragging(false);
                carouselControl.resume();
            }
            carousel.style.transition = '';
            container.style.cursor = 'grab';
        }
    });
    
    container.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const diff = e.pageX - startX;
        currentTranslate = startTranslate + diff * 1.5;
        carousel.style.transform = `translateX(${currentTranslate}px)`;
    });
    
    // Touch events
    let touchStartX = 0;
    let touchStartTranslate = 0;
    
    container.addEventListener('touchstart', (e) => {
        touchStartX = e.touches[0].clientX;
        touchStartTranslate = getAnimationOffset();
        currentTranslate = touchStartTranslate;
        
        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∞–Ω–∏–º–∞—Ü–∏—é
        if (carouselControl) {
            carouselControl.setDragging(true);
            carouselControl.pause();
        }
        
        carousel.style.transition = 'none';
        e.preventDefault();
    });
    
    container.addEventListener('touchmove', (e) => {
        const touchX = e.touches[0].clientX;
        const diff = touchX - touchStartX;
        currentTranslate = touchStartTranslate + diff * 1.5;
        carousel.style.transform = `translateX(${currentTranslate}px)`;
        e.preventDefault();
    });
    
    container.addEventListener('touchend', () => {
        if (carouselControl) {
            carouselControl.setPosition(currentTranslate);
            carouselControl.setDragging(false);
            carouselControl.resume();
        }
        carousel.style.transition = '';
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–∞–π–¥–µ—Ä–æ–≤
function initSliders() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ—á–∫–∏ –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞
    updateMainSliderDots();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞—Ä—É—Å–µ–ª–∏ —Ä–∞–±–æ—Ç
    initWorksCarousels();
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É –≥–ª–∞–≤–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞
    startMainSliderAutoSlide();
    
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    const mainSlider = document.querySelector('.main-content-slider');
    
    if (mainSlider) {
        mainSlider.addEventListener('mouseenter', stopMainSliderAutoSlide);
        mainSlider.addEventListener('mouseleave', startMainSliderAutoSlide);
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–≤–∞–π–ø–æ–≤ –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞
    const mainContentTrack = document.getElementById('mainContentTrack');
    
    if (mainContentTrack) {
        let touchStartX = 0;
        let touchEndX = 0;
        
        mainContentTrack.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        mainContentTrack.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    slideMainContent(1); // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - —Å–ª–µ–¥—É—é—â–∏–π
                } else {
                    slideMainContent(-1); // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –ø—Ä–µ–¥—ã–¥—É—â–∏–π
                }
            }
        });
    }
}

