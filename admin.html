<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - Apple Favorite</title>
    <link rel="icon" type="image/png" href="images/favicon/fhg.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
        }
        
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 250px;
            background: #111;
            padding: 20px;
            border-right: 1px solid #333;
        }
        
        .sidebar h2 {
            margin-bottom: 30px;
            color: #fff;
            font-size: 1.5rem;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-menu li {
            margin-bottom: 10px;
        }
        
        .nav-menu a {
            display: block;
            padding: 12px 15px;
            color: #ccc;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .nav-menu a:hover,
        .nav-menu a.active {
            background: #333;
            color: #fff;
        }
        
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }
        
        .header {
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #111;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .stat-card h3 {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #fff;
        }
        
        .section {
            background: #111;
            padding: 25px;
            border-radius: 8px;
            border: 1px solid #333;
            margin-bottom: 30px;
        }
        
        .section h2 {
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .btn {
            padding: 10px 20px;
            background: #fff;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: #ccc;
        }
        
        .btn-primary {
            background: #007AFF;
            color: #fff;
        }
        
        .btn-primary:hover {
            background: #0056CC;
        }
        
        .btn-danger {
            background: #FF3B30;
            color: #fff;
        }
        
        .btn-danger:hover {
            background: #CC2E24;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #333;
        }
        
        th {
            background: #1a1a1a;
            font-weight: 600;
        }
        
        tr:hover {
            background: #1a1a1a;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 5px;
            color: #fff;
            font-size: 1rem;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #007AFF;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: #111;
            padding: 30px;
            border-radius: 8px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid #333;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-header h2 {
            margin: 0;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #fff;
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
        }
        
        .badge-success {
            background: #34C759;
            color: #000;
        }
        
        .badge-warning {
            background: #FF9500;
            color: #000;
        }
        
        .badge-danger {
            background: #FF3B30;
            color: #fff;
        }
        
        .stock-input {
            width: 80px;
            padding: 5px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 3px;
            color: #fff;
        }
        
        .hidden {
            display: none;
        }
        
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: #000;
        }
        
        .login-box {
            background: #111;
            padding: 40px;
            border-radius: 8px;
            border: 1px solid #333;
            width: 100%;
            max-width: 400px;
        }
        
        .login-box h1 {
            margin-bottom: 30px;
            text-align: center;
        }
        
        .alert {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background: #34C759;
            color: #000;
        }
        
        .alert-error {
            background: #FF3B30;
            color: #fff;
        }
        
        .alert-warning {
            background: #FF9500;
            color: #000;
        }
    </style>
</head>
<body>
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <h1>üîê –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
            <div id="loginAlert"></div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="adminPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <button class="btn btn-primary" id="loginBtn" style="width: 100%;">–í–æ–π—Ç–∏</button>
        </div>
    </div>
    
    <div id="adminPanel" class="admin-container hidden">
        <div class="sidebar">
            <h2>‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
            <ul class="nav-menu">
                <li><a href="#" class="nav-link active" data-section="dashboard">üìä –î–∞—à–±–æ—Ä–¥</a></li>
                <li><a href="#" class="nav-link" data-section="products">üì¶ –¢–æ–≤–∞—Ä—ã</a></li>
                <li><a href="#" class="nav-link" data-section="bulk-operations">‚ö° –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</a></li>
                <li><a href="#" class="nav-link" data-section="orders">üõí –ó–∞–∫–∞–∑—ã</a></li>
                <li><a href="#" class="nav-link" onclick="logout()">üö™ –í—ã—Ö–æ–¥</a></li>
            </ul>
        </div>
        
        <div class="main-content">
            <!-- –î–∞—à–±–æ—Ä–¥ -->
            <div id="dashboard" class="section">
                <div class="header">
                    <h1>üìä –î–∞—à–±–æ—Ä–¥</h1>
                </div>
                <div class="stats-grid" id="statsGrid">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
                <div class="section">
                    <h2>‚ö†Ô∏è –¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º stock</h2>
                    <div id="lowStockProducts"></div>
                </div>
            </div>
            
            <!-- –¢–æ–≤–∞—Ä—ã -->
            <div id="products" class="section hidden">
                <div class="header">
                    <h1>üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h1>
                    <button class="btn btn-primary" onclick="openAddProductModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                </div>
                <div class="form-group">
                    <input type="text" id="productSearch" placeholder="üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." onkeyup="searchProducts()">
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                            <th>–¶–µ–Ω–∞</th>
                            <th>Stock</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="productsTable">
                        <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </tbody>
                </table>
            </div>
            
            <!-- –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
            <div id="bulk-operations" class="section hidden">
                <div class="header">
                    <h1>‚ö° –ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h1>
                </div>
                
                <!-- –ú–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω -->
                <div class="section">
                    <h2>üí∞ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω –Ω–∞ –ø—Ä–æ—Ü–µ–Ω—Ç</h2>
                    <div class="form-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è (–æ—Å—Ç–∞–≤—å—Ç–µ "–í—Å–µ" –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤)</label>
                        <select id="bulkPriceCategory">
                            <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è</label>
                        <input type="number" id="bulkPricePercent" placeholder="10" step="0.1" min="0.1" max="1000">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="radio" name="bulkPriceAction" value="increase" checked> –ü–æ–≤—ã—Å–∏—Ç—å —Ü–µ–Ω—ã
                        </label>
                        <label>
                            <input type="radio" name="bulkPriceAction" value="decrease"> –ü–æ–Ω–∏–∑–∏—Ç—å —Ü–µ–Ω—ã
                        </label>
                    </div>
                    <button class="btn btn-primary" onclick="bulkChangePrices()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω</button>
                    <div id="bulkPriceResult" style="margin-top: 15px;"></div>
                </div>
                
                <!-- –ò–º–ø–æ—Ä—Ç –∏–∑ Excel/CSV -->
                <div class="section">
                    <h2>üì• –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel/CSV</h2>
                    <p style="color: #999; margin-bottom: 15px;">
                        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls, .csv<br>
                        –û–∂–∏–¥–∞–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏: name (–ù–∞–∑–≤–∞–Ω–∏–µ), category (–ö–∞—Ç–µ–≥–æ—Ä–∏—è), price (–¶–µ–Ω–∞), stock (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ), description (–û–ø–∏—Å–∞–Ω–∏–µ), image (–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
                    </p>
                    <div class="form-group">
                        <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</label>
                        <input type="file" id="importFile" accept=".xlsx,.xls,.csv">
                    </div>
                    <button class="btn btn-primary" onclick="importProducts()">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
                    <div id="importResult" style="margin-top: 15px;"></div>
                </div>
            </div>
            
            <!-- –ó–∞–∫–∞–∑—ã -->
            <div id="orders" class="section hidden">
                <div class="header">
                    <h1>üõí –ó–∞–∫–∞–∑—ã</h1>
                </div>
                <div class="form-group">
                    <select id="orderStatusFilter" onchange="loadOrders()">
                        <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                        <option value="pending">–û–∂–∏–¥–∞—é—Ç</option>
                        <option value="reserved">–ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã</option>
                        <option value="paid">–û–ø–ª–∞—á–µ–Ω—ã</option>
                        <option value="processing">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                        <option value="shipped">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã</option>
                        <option value="delivered">–î–æ—Å—Ç–∞–≤–ª–µ–Ω—ã</option>
                        <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω—ã</option>
                    </select>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID –∑–∞–∫–∞–∑–∞</th>
                            <th>–ö–ª–∏–µ–Ω—Ç</th>
                            <th>–¢–æ–≤–∞—Ä—ã</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–∞—Ç–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTable">
                        <!-- –ó–∞–∫–∞–∑—ã –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2>
                <button class="close-btn" onclick="closeProductModal()">&times;</button>
            </div>
            <form id="productForm" enctype="multipart/form-data">
                <input type="hidden" id="productId">
                
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                    <input type="text" id="productName" required>
                </div>
                
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                    <input type="text" id="productCategory" placeholder="iPhone, iPad, MacBook..." required>
                </div>
                
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ (‚ÇΩ) *</label>
                    <input type="number" id="productPrice" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</label>
                    <input type="number" id="productStock" min="0" value="0">
                </div>
                
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="productDescription" rows="4"></textarea>
                </div>
                
                <div class="form-group">
                    <label>–û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (URL –∏–ª–∏ —Ñ–∞–π–ª)</label>
                    <input type="text" id="productImage" placeholder="URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
                    <input type="file" id="productImageFile" accept="image/*" style="margin-top: 10px;">
                </div>
                
                <div class="form-group">
                    <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Ñ–∞–π–ª—ã)</label>
                    <input type="file" id="productImages" accept="image/*" multiple>
                    <div id="imagePreview" style="margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap;"></div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="productActive" checked> –ê–∫—Ç–∏–≤–Ω—ã–π —Ç–æ–≤–∞—Ä
                    </label>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn" onclick="closeProductModal()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        const API_BASE = 'http://localhost:3000/api';
        let adminToken = null;
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            adminToken = localStorage.getItem('adminToken');
            if (adminToken) {
                showAdminPanel();
            }
        });
        
        function login() {
            console.log('–§—É–Ω–∫—Ü–∏—è login() –≤—ã–∑–≤–∞–Ω–∞');
            
            const passwordInput = document.getElementById('adminPassword');
            if (!passwordInput) {
                console.error('–ü–æ–ª–µ –ø–∞—Ä–æ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                alert('–û—à–∏–±–∫–∞: –ü–æ–ª–µ –ø–∞—Ä–æ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                return;
            }
            
            const password = passwordInput.value;
            console.log('–ü–∞—Ä–æ–ª—å –≤–≤–µ–¥–µ–Ω:', password ? '***' : '–ø—É—Å—Ç–æ');
            
            if (!password) {
                console.log('–ü–∞—Ä–æ–ª—å –ø—É—Å—Ç');
                showAlert('loginAlert', '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: admin2025)
            const correctPassword = 'admin2025';
            if (password !== correctPassword) {
                console.log('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
                showAlert('loginAlert', '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error');
                passwordInput.value = '';
                return;
            }
            
            console.log('–ü–∞—Ä–æ–ª—å –≤–µ—Ä–Ω—ã–π, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω...');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
            adminToken = `Bearer ${password}`;
            localStorage.setItem('adminToken', adminToken);
            console.log('–¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            try {
                console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å...');
                showAdminPanel();
                console.log('–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑–∞–Ω–∞');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:', error);
                showAlert('loginAlert', '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞.', 'error');
            }
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤...');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞
            const loginBtn = document.getElementById('loginBtn');
            if (loginBtn) {
                loginBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('–ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–∞–∂–∞—Ç–∞');
                    login();
                });
                console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω');
            } else {
                console.error('–ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ Enter –≤ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è
            const passwordInput = document.getElementById('adminPassword');
            if (passwordInput) {
                passwordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        console.log('Enter –Ω–∞–∂–∞—Ç –≤ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è');
                        login();
                    }
                });
                console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—è –ø–∞—Ä–æ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω');
            } else {
                console.error('–ü–æ–ª–µ –ø–∞—Ä–æ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
            }
        });
        
        function logout() {
            adminToken = null;
            localStorage.removeItem('adminToken');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
        }
        
        function showAdminPanel() {
            const loginScreen = document.getElementById('loginScreen');
            const adminPanel = document.getElementById('adminPanel');
            
            if (!loginScreen || !adminPanel) {
                console.error('–≠–ª–µ–º–µ–Ω—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                return;
            }
            
            loginScreen.classList.add('hidden');
            adminPanel.classList.remove('hidden');
            
            // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞—à–±–æ—Ä–¥, –Ω–æ –Ω–µ –ø–∞–¥–∞–µ–º, –µ—Å–ª–∏ API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω
            try {
                loadDashboard();
            } catch (error) {
                console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞—à–±–æ—Ä–¥ (–≤–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω):', error);
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                const dashboard = document.getElementById('dashboard');
                if (dashboard) {
                    dashboard.innerHTML = `
                        <div class="header">
                            <h1>üìä –î–∞—à–±–æ—Ä–¥</h1>
                        </div>
                        <div class="alert alert-warning">
                            ‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω. –î–ª—è —Ä–∞–±–æ—Ç—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ: <code>npm start</code>
                        </div>
                    `;
                }
            }
        }
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = link.dataset.section;
                if (section) {
                    showSection(section);
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                }
            });
        });
        
        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(sectionName).classList.remove('hidden');
            
            if (sectionName === 'dashboard') {
                loadDashboard();
            } else if (sectionName === 'products') {
                loadProducts();
                loadCategories();
            } else if (sectionName === 'bulk-operations') {
                loadCategoriesForBulk();
            } else if (sectionName === 'orders') {
                loadOrders();
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞
        async function loadCategories() {
            try {
                const response = await fetch(`${API_BASE}/products/categories/list`);
                const data = await response.json();
                if (data.success && data.categories) {
                    // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
        async function loadCategoriesForBulk() {
            try {
                const response = await fetch(`${API_BASE}/products/categories/list`);
                const data = await response.json();
                if (data.success && data.categories) {
                    const select = document.getElementById('bulkPriceCategory');
                    select.innerHTML = '<option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>';
                    data.categories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = cat;
                        select.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞
        async function loadDashboard() {
            try {
                const response = await fetch(`${API_BASE}/admin/stats`, {
                    headers: { 'Authorization': adminToken }
                });
                const data = await response.json();
                
                if (data.success) {
                    const stats = data.stats;
                    document.getElementById('statsGrid').innerHTML = `
                        <div class="stat-card">
                            <h3>–¢–æ–≤–∞—Ä–æ–≤</h3>
                            <div class="value">${stats.totalProducts}</div>
                        </div>
                        <div class="stat-card">
                            <h3>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</h3>
                            <div class="value">${stats.totalOrders}</div>
                        </div>
                        <div class="stat-card">
                            <h3>–û–∂–∏–¥–∞—é—Ç</h3>
                            <div class="value">${stats.pendingOrders}</div>
                        </div>
                        <div class="stat-card">
                            <h3>–û–ø–ª–∞—á–µ–Ω–æ</h3>
                            <div class="value">${stats.paidOrders}</div>
                        </div>
                        <div class="stat-card">
                            <h3>–í—ã—Ä—É—á–∫–∞</h3>
                            <div class="value">${stats.totalRevenue.toLocaleString()} ‚ÇΩ</div>
                        </div>
                    `;
                    
                    // –¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º stock
                    if (stats.lowStockProducts && stats.lowStockProducts.length > 0) {
                        let html = '<table><thead><tr><th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>Stock</th></tr></thead><tbody>';
                        stats.lowStockProducts.forEach(p => {
                            html += `<tr><td>${p.id}</td><td>${p.name}</td><td>${p.stock}</td></tr>`;
                        });
                        html += '</tbody></table>';
                        document.getElementById('lowStockProducts').innerHTML = html;
                    } else {
                        document.getElementById('lowStockProducts').innerHTML = '<p>–í—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –Ω–∞–ª–∏—á–∏–∏</p>';
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
        async function loadProducts() {
            try {
                const response = await fetch(`${API_BASE}/admin/products`, {
                    headers: { 'Authorization': adminToken }
                });
                const data = await response.json();
                
                if (data.success) {
                    let html = '';
                    data.products.forEach(product => {
                        const stock = product.stock || 0;
                        const status = product.active ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω';
                        const statusClass = product.active ? 'success' : 'danger';
                        
                        html += `
                            <tr>
                                <td>${product.id}</td>
                                <td>${product.name}</td>
                                <td>${product.category}</td>
                                <td>${product.price.toLocaleString()} ‚ÇΩ</td>
                                <td>
                                    <input type="number" class="stock-input" value="${stock}" 
                                           onchange="updateStock(${product.id}, this.value)">
                                </td>
                                <td><span class="badge badge-${statusClass}">${status}</span></td>
                                <td>
                                    <button class="btn" onclick="editProduct(${product.id})">‚úèÔ∏è</button>
                                    <button class="btn btn-danger" onclick="deleteProduct(${product.id})">üóëÔ∏è</button>
                                </td>
                            </tr>
                        `;
                    });
                    document.getElementById('productsTable').innerHTML = html;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤
        async function loadOrders() {
            try {
                const status = document.getElementById('orderStatusFilter').value;
                const url = `${API_BASE}/admin/orders${status ? '?status=' + status : ''}`;
                const response = await fetch(url, {
                    headers: { 'Authorization': adminToken }
                });
                const data = await response.json();
                
                if (data.success) {
                    let html = '';
                    data.orders.forEach(order => {
                        const statusBadges = {
                            'pending': 'badge-warning',
                            'reserved': 'badge-warning',
                            'paid': 'badge-success',
                            'processing': 'badge-success',
                            'shipped': 'badge-success',
                            'delivered': 'badge-success',
                            'cancelled': 'badge-danger'
                        };
                        const statusText = {
                            'pending': '–û–∂–∏–¥–∞–µ—Ç',
                            'reserved': '–ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω',
                            'paid': '–û–ø–ª–∞—á–µ–Ω',
                            'processing': '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
                            'shipped': '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω',
                            'delivered': '–î–æ—Å—Ç–∞–≤–ª–µ–Ω',
                            'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
                        };
                        
                        html += `
                            <tr>
                                <td>${order.orderId}</td>
                                <td>${order.customer.name}<br>${order.customer.phone}</td>
                                <td>${order.items.length} —Ç–æ–≤–∞—Ä(–æ–≤)</td>
                                <td>${order.total.toLocaleString()} ‚ÇΩ</td>
                                <td><span class="badge ${statusBadges[order.status]}">${statusText[order.status]}</span></td>
                                <td>${new Date(order.createdAt).toLocaleDateString()}</td>
                                <td>
                                    <button class="btn" onclick="viewOrder('${order.orderId}')">üëÅÔ∏è</button>
                                    <select onchange="updateOrderStatus('${order.orderId}', this.value)">
                                        <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>–û–∂–∏–¥–∞–µ—Ç</option>
                                        <option value="paid" ${order.status === 'paid' ? 'selected' : ''}>–û–ø–ª–∞—á–µ–Ω</option>
                                        <option value="processing" ${order.status === 'processing' ? 'selected' : ''}>–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                                        <option value="shipped" ${order.status === 'shipped' ? 'selected' : ''}>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                                        <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>–î–æ—Å—Ç–∞–≤–ª–µ–Ω</option>
                                        <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>–û—Ç–º–µ–Ω–µ–Ω</option>
                                    </select>
                                </td>
                            </tr>
                        `;
                    });
                    document.getElementById('ordersTable').innerHTML = html;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤:', error);
            }
        }
        
        async function updateStock(productId, stock) {
            try {
                const response = await fetch(`${API_BASE}/admin/products/${productId}/stock`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': adminToken,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ stock: parseInt(stock) })
                });
                const data = await response.json();
                if (data.success) {
                    showAlert('products', 'Stock –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è stock:', error);
            }
        }
        
        async function updateOrderStatus(orderId, status) {
            try {
                const response = await fetch(`${API_BASE}/admin/orders/${orderId}/status`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': adminToken,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status })
                });
                const data = await response.json();
                if (data.success) {
                    loadOrders();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
            }
        }
        
        function showAlert(containerId, message, type) {
            let container = document.getElementById(containerId);
            if (!container) {
                // –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º –∞–ª–µ—Ä—Ç –≤ —Ç–µ–∫—É—â–µ–π —Å–µ–∫—Ü–∏–∏
                const sections = document.querySelectorAll('.section:not(.hidden)');
                if (sections.length > 0) {
                    container = sections[0];
                } else {
                    console.error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω:', containerId);
                    return;
                }
            }
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            container.insertBefore(alert, container.firstChild);
            setTimeout(() => alert.remove(), 5000);
        }
        
        function searchProducts() {
            // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
            loadProducts();
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
        function openAddProductModal() {
            document.getElementById('modalTitle').textContent = '–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä';
            document.getElementById('productForm').reset();
            document.getElementById('productId').value = '';
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('productModal').classList.add('active');
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
        async function editProduct(id) {
            try {
                const response = await fetch(`${API_BASE}/admin/products`, {
                    headers: { 'Authorization': adminToken }
                });
                const data = await response.json();
                
                if (data.success) {
                    const product = data.products.find(p => p.id === id);
                    if (product) {
                        document.getElementById('modalTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä';
                        document.getElementById('productId').value = product.id;
                        document.getElementById('productName').value = product.name || '';
                        document.getElementById('productCategory').value = product.category || '';
                        document.getElementById('productPrice').value = product.price || 0;
                        document.getElementById('productStock').value = product.stock || 0;
                        document.getElementById('productDescription').value = product.description || '';
                        document.getElementById('productImage').value = product.image || '';
                        document.getElementById('productActive').checked = product.active !== false;
                        
                        // –û—á–∏—â–∞–µ–º –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                        document.getElementById('imagePreview').innerHTML = '';
                        if (product.images && product.images.length > 0) {
                            product.images.forEach(img => {
                                const imgEl = document.createElement('img');
                                imgEl.src = img;
                                imgEl.style.width = '100px';
                                imgEl.style.height = '100px';
                                imgEl.style.objectFit = 'cover';
                                imgEl.style.borderRadius = '5px';
                                document.getElementById('imagePreview').appendChild(imgEl);
                            });
                        }
                        
                        document.getElementById('productModal').classList.add('active');
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–∞:', error);
                showAlert('products', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–∞', 'error');
            }
        }
        
        // –£–¥–∞–ª–∏—Ç—å/–¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä
        async function deleteProduct(id) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                try {
                    const response = await fetch(`${API_BASE}/admin/products/${id}`, {
                        method: 'DELETE',
                        headers: { 'Authorization': adminToken }
                    });
                    const data = await response.json();
                    
                    if (data.success) {
                        showAlert('products', '–¢–æ–≤–∞—Ä –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω', 'success');
                        loadProducts();
                    } else {
                        showAlert('products', data.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞', 'error');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:', error);
                    showAlert('products', '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞', 'error');
                }
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
        document.getElementById('productForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const productId = document.getElementById('productId').value;
            const formData = new FormData();
            
            const productData = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                price: parseFloat(document.getElementById('productPrice').value),
                stock: parseInt(document.getElementById('productStock').value) || 0,
                description: document.getElementById('productDescription').value,
                image: document.getElementById('productImage').value,
                active: document.getElementById('productActive').checked
            };
            
            formData.append('product', JSON.stringify(productData));
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            const imageFile = document.getElementById('productImageFile').files[0];
            const imageFiles = document.getElementById('productImages').files;
            
            if (imageFile) {
                formData.append('images', imageFile);
            }
            
            for (let i = 0; i < imageFiles.length; i++) {
                formData.append('images', imageFiles[i]);
            }
            
            try {
                const url = productId 
                    ? `${API_BASE}/admin/products/${productId}`
                    : `${API_BASE}/admin/products`;
                const method = productId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: { 'Authorization': adminToken },
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showAlert('products', productId ? '–¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω' : '–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω', 'success');
                    closeProductModal();
                    loadProducts();
                } else {
                    showAlert('products', data.error || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:', error);
                showAlert('products', '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞', 'error');
            }
        });
        
        // –ú–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω
        async function bulkChangePrices() {
            const percent = parseFloat(document.getElementById('bulkPricePercent').value);
            const category = document.getElementById('bulkPriceCategory').value;
            const action = document.querySelector('input[name="bulkPriceAction"]:checked').value;
            const increase = action === 'increase';
            
            if (!percent || percent <= 0) {
                showAlert('bulk-operations', '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç', 'error');
                return;
            }
            
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ ${increase ? '–ø–æ–≤—ã—Å–∏—Ç—å' : '–ø–æ–Ω–∏–∑–∏—Ç—å'} —Ü–µ–Ω—ã –Ω–∞ ${percent}%?`)) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/admin/products/bulk-price-change`, {
                    method: 'POST',
                    headers: {
                        'Authorization': adminToken,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ percent, category, increase })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    const resultDiv = document.getElementById('bulkPriceResult');
                    resultDiv.innerHTML = `<div class="alert alert-success">${data.message}</div>`;
                    setTimeout(() => resultDiv.innerHTML = '', 5000);
                    loadProducts();
                } else {
                    showAlert('bulk-operations', data.error || '–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω:', error);
                showAlert('bulk-operations', '–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω', 'error');
            }
        }
        
        // –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel/CSV
        async function importProducts() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showAlert('bulk-operations', '–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞', 'error');
                return;
            }
            
            if (!confirm('–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –∏–∑ —Ñ–∞–π–ª–∞? –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã —Å —Ç–µ–º –∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω—ã.')) {
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            try {
                const resultDiv = document.getElementById('importResult');
                resultDiv.innerHTML = '<div class="alert">–ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤...</div>';
                
                const response = await fetch(`${API_BASE}/admin/products/import`, {
                    method: 'POST',
                    headers: { 'Authorization': adminToken },
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            ${data.message}<br>
                            –°–æ–∑–¥–∞–Ω–æ: ${data.results.created}, –û–±–Ω–æ–≤–ª–µ–Ω–æ: ${data.results.updated}
                            ${data.results.errors.length > 0 ? '<br>–û—à–∏–±–∫–∏: ' + data.results.errors.length : ''}
                        </div>
                    `;
                    fileInput.value = '';
                    loadProducts();
                } else {
                    resultDiv.innerHTML = `<div class="alert alert-error">${data.error}</div>`;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:', error);
                document.getElementById('importResult').innerHTML = '<div class="alert alert-error">–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤</div>';
            }
        }
        
        function viewOrder(orderId) {
            alert(`–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞ ${orderId} –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω`);
        }
        
        function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
            document.getElementById('productForm').reset();
            document.getElementById('imagePreview').innerHTML = '';
        }
    </script>
</body>
</html>

