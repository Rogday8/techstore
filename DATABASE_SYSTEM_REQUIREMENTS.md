# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

## üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–≤–æ–π–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–æ–≤–∞—Ä–∞ (race condition)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

---

## üì¶ –ß—Ç–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è

### 1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**

#### –í–∞—Ä–∏–∞–Ω—Ç A: MongoDB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)
```bash
npm install mongoose
```
**–ü–ª—é—Å—ã:**
- –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –ì–∏–±–∫–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Node.js
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–±–ª–∞—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (MongoDB Atlas)

#### –í–∞—Ä–∏–∞–Ω—Ç B: PostgreSQL
```bash
npm install pg sequelize
```
**–ü–ª—é—Å—ã:**
- –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–≤–æ–π–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫)
- SQL –∑–∞–ø—Ä–æ—Å—ã

#### –í–∞—Ä–∏–∞–Ω—Ç C: SQLite (–¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)
```bash
npm install better-sqlite3
```
**–ü–ª—é—Å—ã:**
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

---

### 2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

#### –¢–∞–±–ª–∏—Ü–∞/–ö–æ–ª–ª–µ–∫—Ü–∏—è: `products`
```javascript
{
  id: 1,
  name: "iPhone 15 Pro Max",
  description: "...",
  price: 129990,
  category: "–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã",
  stock: 10,                    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ
  reserved: 0,                   // –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–ø–ª–∞—Ç—ã)
  images: [...],
  colors: {...},
  memoryOptions: {...},
  createdAt: "2025-01-XX",
  updatedAt: "2025-01-XX"
}
```

#### –¢–∞–±–ª–∏—Ü–∞/–ö–æ–ª–ª–µ–∫—Ü–∏—è: `orders`
```javascript
{
  id: "order_1234567890",
  userId: "user_123",            // –ò–ª–∏ sessionId –¥–ª—è –≥–æ—Å—Ç–µ–π
  items: [
    {
      productId: 1,
      productName: "iPhone 15 Pro Max",
      color: "–ß–µ—Ä–Ω—ã–π",
      memory: "256GB",
      quantity: 1,
      price: 129990
    }
  ],
  total: 129990,
  status: "pending" | "paid" | "cancelled" | "completed",
  paymentId: "payment_xxx",
  createdAt: "2025-01-XX",
  expiresAt: "2025-01-XX"        // –î–ª—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
}
```

#### –¢–∞–±–ª–∏—Ü–∞/–ö–æ–ª–ª–µ–∫—Ü–∏—è: `reservations`
```javascript
{
  id: "reservation_123",
  orderId: "order_1234567890",
  productId: 1,
  quantity: 1,
  expiresAt: "2025-01-XX",       // –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 15 –º–∏–Ω—É—Ç
  createdAt: "2025-01-XX"
}
```

---

### 3. **Backend API (Node.js/Express)**

#### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã:
```bash
npm install mongoose express cors body-parser
npm install socket.io          # –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
npm install redis              # –î–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ API endpoints:

**GET `/api/products`**
- –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ products: [...], stock: {...} }`

**GET `/api/products/:id`**
- –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ product: {...}, stock: 10, available: true }`

**POST `/api/orders/reserve`**
- –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä –ø–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ–π
- **–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é/–±–ª–æ–∫–∏—Ä–æ–≤–∫—É
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ success: true, reservationId: "...", expiresAt: "..." }`

**POST `/api/orders/create`**
- –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (–ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã)
- –£–º–µ–Ω—å—à–∞–µ—Ç stock
- –£–¥–∞–ª—è–µ—Ç —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ success: true, orderId: "..." }`

**POST `/api/orders/cancel`**
- –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑/—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç stock –æ–±—Ä–∞—Ç–Ω–æ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ success: true }`

**GET `/api/orders/:id`**
- –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞

---

### 4. **–ó–∞—â–∏—Ç–∞ –æ—Ç Race Condition (–¥–≤–æ–π–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫)**

#### –ú–µ—Ç–æ–¥ 1: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```javascript
// MongoDB —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
const session = await mongoose.startSession();
session.startTransaction();

try {
  const product = await Product.findOne({ id: productId }).session(session);
  
  if (product.stock < quantity) {
    throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞');
  }
  
  product.stock -= quantity;
  await product.save({ session });
  
  await session.commitTransaction();
} catch (error) {
  await session.abortTransaction();
  throw error;
} finally {
  session.endSession();
}
```

#### –ú–µ—Ç–æ–¥ 2: Redis –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```javascript
const redis = require('redis');
const client = redis.createClient();

async function reserveProduct(productId, quantity) {
  const lockKey = `lock:product:${productId}`;
  const lock = await client.set(lockKey, 'locked', 'EX', 10, 'NX'); // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 10 —Å–µ–∫
  
  if (!lock) {
    throw new Error('–¢–æ–≤–∞—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ');
  }
  
  try {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
    const product = await Product.findOne({ id: productId });
    if (product.stock < quantity) {
      throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞');
    }
    product.stock -= quantity;
    await product.save();
  } finally {
    await client.del(lockKey); // –°–Ω–∏–º–∞–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
  }
}
```

#### –ú–µ—Ç–æ–¥ 3: –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
```javascript
// –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ version –≤ —Å—Ö–µ–º—É –ø—Ä–æ–¥—É–∫—Ç–∞
{
  stock: 10,
  version: 1  // –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
}

// –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é
const result = await Product.updateOne(
  { id: productId, version: currentVersion },
  { $inc: { stock: -quantity, version: 1 } }
);

if (result.modifiedCount === 0) {
  throw new Error('–¢–æ–≤–∞—Ä –±—ã–ª –∏–∑–º–µ–Ω–µ–Ω, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É');
}
```

---

### 5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**

#### –í–∞—Ä–∏–∞–Ω—Ç A: WebSocket (Socket.io)
```javascript
// Server
const io = require('socket.io')(server);

io.on('connection', (socket) => {
  socket.on('subscribe:products', () => {
    socket.join('products');
  });
});

// –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ stock
io.to('products').emit('stock:update', {
  productId: 1,
  stock: 9,
  available: true
});
```

```javascript
// Client (script.js)
const socket = io();

socket.on('stock:update', (data) => {
  updateProductStock(data.productId, data.stock);
  if (data.stock === 0) {
    showOutOfStock(data.productId);
  }
});
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: Polling (–ø—Ä–æ—â–µ, –Ω–æ –º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
```javascript
// Client –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç stock
setInterval(async () => {
  const response = await fetch('/api/products/stock');
  const data = await response.json();
  updateStocks(data);
}, 5000);
```

---

### 6. **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤**

**–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∫—É–ø–∫–∏:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É
2. –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ –æ–ø–ª–∞—Ç–µ ‚Üí **—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 15 –º–∏–Ω—É—Ç**
3. –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞ ‚Üí —Ç–æ–≤–∞—Ä —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è
4. –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞/–æ—Ç–º–µ–Ω–µ–Ω–∞ ‚Üí —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è, stock –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è
5. –ï—Å–ª–∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–µ–∫–ª–æ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ stock

**Cron job –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–µ–∫—à–∏—Ö —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–π:**
```javascript
const cron = require('node-cron');

// –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å—Ç–µ–∫—à–∏–µ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è
cron.schedule('* * * * *', async () => {
  const expired = await Reservation.find({
    expiresAt: { $lt: new Date() }
  });
  
  for (const res of expired) {
    await Product.updateOne(
      { id: res.productId },
      { $inc: { stock: res.quantity } }
    );
    await Reservation.deleteOne({ _id: res._id });
  }
});
```

---

### 7. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π**

**–¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞:** Google Pay / –¥—Ä—É–≥–∏–µ –ø–ª–∞—Ç–µ–∂–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–û–ø–ª–∞—Ç–∏—Ç—å"
2. –°–æ–∑–¥–∞–µ—Ç—Å—è —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
3. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Ñ–æ—Ä–º–∞
4. –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ:
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑
   - –¢–æ–≤–∞—Ä —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∏–∑ stock
   - –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è
5. –ü—Ä–∏ –æ—à–∏–±–∫–µ –æ–ø–ª–∞—Ç—ã:
   - –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è
   - Stock –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è

---

### 8. **–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```
project/
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Product.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Order.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Reservation.js
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ orders.js
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stockService.js    # –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–æ stock
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reservationService.js
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stockLock.js       # Middleware –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ server.js
‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îú‚îÄ‚îÄ script.js              # –û–±–Ω–æ–≤–∏—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ package.json
```

---

### 9. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ frontend (script.js)**

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ API –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è stock —á–µ—Ä–µ–∑ WebSocket
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ –∫–æ—Ä–∑–∏–Ω—É
- –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ –æ–ø–ª–∞—Ç–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ "—Ç–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è"

```javascript
// –ü—Ä–∏–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
async function addToCart(productId, color, memory) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
  const response = await fetch(`/api/products/${productId}/check`, {
    method: 'POST',
    body: JSON.stringify({ color, memory, quantity: 1 })
  });
  
  const data = await response.json();
  
  if (!data.available) {
    alert('–¢–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è');
    return;
  }
  
  // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ—Ä–∑–∏–Ω—É
  cart.push({ productId, color, memory });
  localStorage.setItem('cart', JSON.stringify(cart));
}
```

---

### 10. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã**

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ
npm install mongoose express cors body-parser
npm install socket.io socket.io-client

# –î–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
npm install redis ioredis

# –î–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–¥–∞—á
npm install node-cron

# –î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
npm install joi

# –î–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
npm install winston
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **Rate Limiting** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. **HTTPS** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
4. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è stock
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å stock –¥–æ–ª–∂–Ω—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –õ–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ stock
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–æ–≤–∞—Ä–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤

---

## üöÄ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

1. **–≠—Ç–∞–ø 1:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (MongoDB)
2. **–≠—Ç–∞–ø 2:** –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ —Å—Ö–µ–º
3. **–≠—Ç–∞–ø 3:** API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–≤–∞—Ä–∞–º–∏
4. **–≠—Ç–∞–ø 4:** –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è
5. **–≠—Ç–∞–ø 5:** –ó–∞—â–∏—Ç–∞ –æ—Ç race condition
6. **–≠—Ç–∞–ø 6:** WebSocket –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
7. **–≠—Ç–∞–ø 7:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å frontend
8. **–≠—Ç–∞–ø 8:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–ù–∞—á–∞—Ç—å —Å MongoDB** - –ø—Ä–æ—â–µ –¥–ª—è –Ω–∞—á–∞–ª–∞
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis** - –¥–ª—è –Ω–∞–¥–µ–∂–Ω—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- **WebSocket –≤–º–µ—Å—Ç–æ polling** - –ª—É—á—à–µ –¥–ª—è UX
- **–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 15 –º–∏–Ω—É—Ç** - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- **–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ** - –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è

1. –ö–∞–∫–æ–π –æ–±—ä–µ–º —Ç–æ–≤–∞—Ä–æ–≤ –æ–∂–∏–¥–∞–µ—Ç—Å—è? (–≤–ª–∏—è–µ—Ç –Ω–∞ –≤—ã–±–æ—Ä –ë–î)
2. –°–∫–æ–ª—å–∫–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π? (–≤–ª–∏—è–µ—Ç –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É)
3. –ù—É–∂–Ω–∞ –ª–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è stock?
4. –ö–∞–∫–∞—è –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è?
5. –ù—É–∂–Ω–∞ –ª–∏ —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞?

